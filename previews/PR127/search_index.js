var documenterSearchIndex = {"docs":
[{"location":"examples/variational/","page":"Variational problems","title":"Variational problems","text":"EditURL = \"https://github.com/JuliaOptimalTransport/OptimalTransport.jl/blob/master/examples/variational/script.jl\"","category":"page"},{"location":"examples/variational/#Variational-problems","page":"Variational problems","title":"Variational problems","text":"","category":"section"},{"location":"examples/variational/","page":"Variational problems","title":"Variational problems","text":"(Image: )","category":"page"},{"location":"examples/variational/","page":"Variational problems","title":"Variational problems","text":"You are seeing the HTML output generated by Documenter.jl and Literate.jl from the Julia source file. The corresponding notebook can be viewed in nbviewer.","category":"page"},{"location":"examples/variational/","page":"Variational problems","title":"Variational problems","text":"In this example, we will numerically simulate an entropy-regularised Wasserstein gradient flow approximating the Fokker-Planck and porous medium equations.","category":"page"},{"location":"examples/variational/","page":"Variational problems","title":"Variational problems","text":"The connection between Wasserstein gradient flows and (non)-linear PDEs is due to Jordan, Kinderlehrer and Otto [JKO98], and an easy-to-read overview of the topic is provided in Section 9.3 [PC19]","category":"page"},{"location":"examples/variational/","page":"Variational problems","title":"Variational problems","text":"[JKO98]: Jordan, Richard, David Kinderlehrer, and Felix Otto. \"The variational formulation of the Fokker–Planck equation.\" SIAM journal on mathematical analysis 29.1 (1998): 1-17.","category":"page"},{"location":"examples/variational/","page":"Variational problems","title":"Variational problems","text":"[PC19]: Peyré, Gabriel, and Marco Cuturi. \"Computational optimal transport: With applications to data science.\" Foundations and Trends® in Machine Learning 11.5-6 (2019): 355-607.","category":"page"},{"location":"examples/variational/#Fokker-Planck-equation-as-a-W_2-gradient-flow","page":"Variational problems","title":"Fokker-Planck equation as a W_2 gradient flow","text":"","category":"section"},{"location":"examples/variational/","page":"Variational problems","title":"Variational problems","text":"For a potential function Psi and noise level sigma^2, the Fokker-Planck equation (FPE) is","category":"page"},{"location":"examples/variational/","page":"Variational problems","title":"Variational problems","text":"partial_t rho_t = nabla cdot (rho_t nabla Psi) + fracsigma^22 Delta rho_t","category":"page"},{"location":"examples/variational/","page":"Variational problems","title":"Variational problems","text":"and we take no-flux (Neumann) boundary conditions.","category":"page"},{"location":"examples/variational/","page":"Variational problems","title":"Variational problems","text":"This describes the evolution of a massless particle undergoing both diffusion (with diffusivity sigma^2) and drift (along potential Psi) according to the stochastic differential equation","category":"page"},{"location":"examples/variational/","page":"Variational problems","title":"Variational problems","text":"dX_t = -nabla Psi(X_t) dt + sigma dB_t","category":"page"},{"location":"examples/variational/","page":"Variational problems","title":"Variational problems","text":"The result of Jordan, Kinderlehrer and Otto (commonly referred to as the JKO theorem) states that rho_t evolves following the 2-Wasserstein gradient flow of the Gibbs free energy functional","category":"page"},{"location":"examples/variational/","page":"Variational problems","title":"Variational problems","text":"  F(rho) = int Psi drho + int log(rho) drho","category":"page"},{"location":"examples/variational/#Implicit-schemes-for-gradient-flows","page":"Variational problems","title":"Implicit schemes for gradient flows","text":"","category":"section"},{"location":"examples/variational/","page":"Variational problems","title":"Variational problems","text":"In an Euclidean space, the gradient flow of a functional F is simply the solution of an ordinary differential equation","category":"page"},{"location":"examples/variational/","page":"Variational problems","title":"Variational problems","text":" dfracdx(t)dt = -nabla F(x(t))","category":"page"},{"location":"examples/variational/","page":"Variational problems","title":"Variational problems","text":"Of course, there is a requirement that F is smooth. A more general formulation of a gradient flow that allows F to be non-smooth is the implicit scheme","category":"page"},{"location":"examples/variational/","page":"Variational problems","title":"Variational problems","text":"  x_t+tau = operatornameargmin_x frac12  x - x_t _2^2 + tau F(x)","category":"page"},{"location":"examples/variational/","page":"Variational problems","title":"Variational problems","text":"As the timestep tau shrinks, x_t becomes a better and better approximation to the gradient flow of F.","category":"page"},{"location":"examples/variational/#Wasserstein-gradient-flow","page":"Variational problems","title":"Wasserstein gradient flow","text":"","category":"section"},{"location":"examples/variational/","page":"Variational problems","title":"Variational problems","text":"In the context of the JKO theorem, we seek rho_t that is the gradient flow of F with respect to the 2-Wasserstein distance. This can be achieved by choosing the W_2 metric in the implicit step:","category":"page"},{"location":"examples/variational/","page":"Variational problems","title":"Variational problems","text":"  rho_t + tau = operatornameargmin_rho d_W_2^2(rho_t rho) + tau F(rho)","category":"page"},{"location":"examples/variational/","page":"Variational problems","title":"Variational problems","text":"Finally, a numerical scheme for computing this gradient flow can be developed by using the entropic regularisation of optimal transport on a discretised domain","category":"page"},{"location":"examples/variational/","page":"Variational problems","title":"Variational problems","text":"  rho_t + tau = operatornameargmin_rho operatornameOT_varepsilon(rho_t rho) + tau F(rho)","category":"page"},{"location":"examples/variational/","page":"Variational problems","title":"Variational problems","text":"where","category":"page"},{"location":"examples/variational/","page":"Variational problems","title":"Variational problems","text":"  operatornameOT_varepsilon(alpha beta) = min_gamma in Pi(alpha beta) sum_ij frac12  x_i - x_j _2^2 gamma_ij + varepsilon sum_i j gamma_ij log(gamma_ij)","category":"page"},{"location":"examples/variational/","page":"Variational problems","title":"Variational problems","text":"Each step of this problem is a minimisation problem with respect to rho. Since we use entropic optimal transport which is differentiable, this can be solved using gradient-based methods.","category":"page"},{"location":"examples/variational/#Problem-setup","page":"Variational problems","title":"Problem setup","text":"","category":"section"},{"location":"examples/variational/","page":"Variational problems","title":"Variational problems","text":"using OptimalTransport\nusing StatsBase, Distances\nusing ReverseDiff, Optim, LinearAlgebra\nusing Plots\nusing LogExpFunctions\nusing LaTeXStrings\nusing Suppressor","category":"page"},{"location":"examples/variational/","page":"Variational problems","title":"Variational problems","text":"Here, we set up the computational domain that we work on - we discretize the interval -1 1. The natural boundary conditions to use will be Neumann (zero flux), see e.g. [Santam2017]","category":"page"},{"location":"examples/variational/","page":"Variational problems","title":"Variational problems","text":"[Santam2017]: Santambrogio, Filippo. \"{Euclidean, metric, and Wasserstein} gradient flows: an overview.\" Bulletin of Mathematical Sciences 7.1 (2017): 87-154.","category":"page"},{"location":"examples/variational/","page":"Variational problems","title":"Variational problems","text":"support = range(-1, 1; length=64)\nC = pairwise(SqEuclidean(), support');","category":"page"},{"location":"examples/variational/","page":"Variational problems","title":"Variational problems","text":"Now we set up various functionals that we will use.","category":"page"},{"location":"examples/variational/","page":"Variational problems","title":"Variational problems","text":"We define the generalised entropy (Equation (4.4) of [Peyre2015]) as follows. For m = 1 this is just the \"regular\" entropy, and m = 2 this is squared L_2.","category":"page"},{"location":"examples/variational/","page":"Variational problems","title":"Variational problems","text":"[Peyre2015]: Peyré, Gabriel. \"Entropic approximation of Wasserstein gradient flows.\" SIAM Journal on Imaging Sciences 8.4 (2015): 2323-2351.","category":"page"},{"location":"examples/variational/","page":"Variational problems","title":"Variational problems","text":"function E(ρ; m=1)\n    if m == 1\n        return sum(xlogx.(ρ)) - sum(ρ)\n    elseif m > 1\n        return dot(ρ, @. (ρ^(m - 1) - m) / (m - 1))\n    end\nend;","category":"page"},{"location":"examples/variational/","page":"Variational problems","title":"Variational problems","text":"Now define psi(x) to be a potential energy function that has two potential wells at x =  05.","category":"page"},{"location":"examples/variational/","page":"Variational problems","title":"Variational problems","text":"ψ(x) = 10 * (x - 0.5)^2 * (x + 0.5)^2;\nplot(support, ψ.(support); color=\"black\", label=\"Scalar potential\")","category":"page"},{"location":"examples/variational/","page":"Variational problems","title":"Variational problems","text":"(Image: )","category":"page"},{"location":"examples/variational/","page":"Variational problems","title":"Variational problems","text":"Having defined psi, this induces a potential energy functional Psi on probability distributions rho:","category":"page"},{"location":"examples/variational/","page":"Variational problems","title":"Variational problems","text":"   Psi(rho) = int psi(x) rho(x) dx = langle psi rho rangle ","category":"page"},{"location":"examples/variational/","page":"Variational problems","title":"Variational problems","text":"Ψ = ψ.(support);","category":"page"},{"location":"examples/variational/","page":"Variational problems","title":"Variational problems","text":"Define the time step tau and entropic regularisation level varepsilon, and form the associated Gibbs kernel K = e^-Cvarepsilon.","category":"page"},{"location":"examples/variational/","page":"Variational problems","title":"Variational problems","text":"τ = 0.05\nε = 0.01\nK = @. exp(-C / ε)","category":"page"},{"location":"examples/variational/","page":"Variational problems","title":"Variational problems","text":"64×64 Matrix{Float64}:\n 1.0           0.904131      0.668229      0.403722      0.199389      0.0804977     0.0265661     0.00716698    0.00158054    0.00028493    4.19889e-5    5.05816e-6    4.98097e-7    4.00957e-8    2.63842e-9    1.41923e-10   6.24057e-12  2.24315e-13  6.59107e-15  1.58313e-16  3.10841e-18  4.98911e-20  6.54592e-22  7.02072e-24  6.15538e-26  4.41154e-28  2.58457e-30  1.2378e-32   4.8459e-35   1.55082e-37  4.05705e-40  8.67605e-43  1.51669e-45  2.16738e-48  2.53183e-51  2.41767e-54  1.88722e-57  1.20423e-60  6.28148e-64  2.6784e-67   9.3358e-71   2.66005e-74  6.19572e-78  1.17966e-81  1.83605e-85  2.336e-89    2.42955e-93  2.06557e-97  1.43555e-101  8.15565e-106  3.78758e-110  1.4379e-114   4.46227e-119  1.132e-123    2.34748e-128  3.9794e-133   5.51438e-138  6.24653e-143  5.7842e-148   4.37836e-153  2.7092e-158   1.37036e-163  5.66616e-169  1.91517e-174\n 0.904131      1.0           0.904131      0.668229      0.403722      0.199389      0.0804977     0.0265661     0.00716698    0.00158054    0.00028493    4.19889e-5    5.05816e-6    4.98097e-7    4.00957e-8    2.63842e-9    1.41923e-10  6.24057e-12  2.24315e-13  6.59107e-15  1.58313e-16  3.10841e-18  4.98911e-20  6.54592e-22  7.02072e-24  6.15538e-26  4.41154e-28  2.58457e-30  1.2378e-32   4.8459e-35   1.55082e-37  4.05705e-40  8.67605e-43  1.51669e-45  2.16738e-48  2.53183e-51  2.41767e-54  1.88722e-57  1.20423e-60  6.28148e-64  2.6784e-67   9.3358e-71   2.66005e-74  6.19572e-78  1.17966e-81  1.83605e-85  2.336e-89    2.42955e-93  2.06557e-97   1.43555e-101  8.15565e-106  3.78758e-110  1.4379e-114   4.46227e-119  1.132e-123    2.34748e-128  3.9794e-133   5.51438e-138  6.24653e-143  5.7842e-148   4.37836e-153  2.7092e-158   1.37036e-163  5.66616e-169\n 0.668229      0.904131      1.0           0.904131      0.668229      0.403722      0.199389      0.0804977     0.0265661     0.00716698    0.00158054    0.00028493    4.19889e-5    5.05816e-6    4.98097e-7    4.00957e-8    2.63842e-9   1.41923e-10  6.24057e-12  2.24315e-13  6.59107e-15  1.58313e-16  3.10841e-18  4.98911e-20  6.54592e-22  7.02072e-24  6.15538e-26  4.41154e-28  2.58457e-30  1.2378e-32   4.8459e-35   1.55082e-37  4.05705e-40  8.67605e-43  1.51669e-45  2.16738e-48  2.53183e-51  2.41767e-54  1.88722e-57  1.20423e-60  6.28148e-64  2.6784e-67   9.3358e-71   2.66005e-74  6.19572e-78  1.17966e-81  1.83605e-85  2.336e-89    2.42955e-93   2.06557e-97   1.43555e-101  8.15565e-106  3.78758e-110  1.4379e-114   4.46227e-119  1.132e-123    2.34748e-128  3.9794e-133   5.51438e-138  6.24653e-143  5.7842e-148   4.37836e-153  2.7092e-158   1.37036e-163\n 0.403722      0.668229      0.904131      1.0           0.904131      0.668229      0.403722      0.199389      0.0804977     0.0265661     0.00716698    0.00158054    0.00028493    4.19889e-5    5.05816e-6    4.98097e-7    4.00957e-8   2.63842e-9   1.41923e-10  6.24057e-12  2.24315e-13  6.59107e-15  1.58313e-16  3.10841e-18  4.98911e-20  6.54592e-22  7.02072e-24  6.15538e-26  4.41154e-28  2.58457e-30  1.2378e-32   4.8459e-35   1.55082e-37  4.05705e-40  8.67605e-43  1.51669e-45  2.16738e-48  2.53183e-51  2.41767e-54  1.88722e-57  1.20423e-60  6.28148e-64  2.6784e-67   9.3358e-71   2.66005e-74  6.19572e-78  1.17966e-81  1.83605e-85  2.336e-89     2.42955e-93   2.06557e-97   1.43555e-101  8.15565e-106  3.78758e-110  1.4379e-114   4.46227e-119  1.132e-123    2.34748e-128  3.9794e-133   5.51438e-138  6.24653e-143  5.7842e-148   4.37836e-153  2.7092e-158\n 0.199389      0.403722      0.668229      0.904131      1.0           0.904131      0.668229      0.403722      0.199389      0.0804977     0.0265661     0.00716698    0.00158054    0.00028493    4.19889e-5    5.05816e-6    4.98097e-7   4.00957e-8   2.63842e-9   1.41923e-10  6.24057e-12  2.24315e-13  6.59107e-15  1.58313e-16  3.10841e-18  4.98911e-20  6.54592e-22  7.02072e-24  6.15538e-26  4.41154e-28  2.58457e-30  1.2378e-32   4.8459e-35   1.55082e-37  4.05705e-40  8.67605e-43  1.51669e-45  2.16738e-48  2.53183e-51  2.41767e-54  1.88722e-57  1.20423e-60  6.28148e-64  2.6784e-67   9.3358e-71   2.66005e-74  6.19572e-78  1.17966e-81  1.83605e-85   2.336e-89     2.42955e-93   2.06557e-97   1.43555e-101  8.15565e-106  3.78758e-110  1.4379e-114   4.46227e-119  1.132e-123    2.34748e-128  3.9794e-133   5.51438e-138  6.24653e-143  5.7842e-148   4.37836e-153\n 0.0804977     0.199389      0.403722      0.668229      0.904131      1.0           0.904131      0.668229      0.403722      0.199389      0.0804977     0.0265661     0.00716698    0.00158054    0.00028493    4.19889e-5    5.05816e-6   4.98097e-7   4.00957e-8   2.63842e-9   1.41923e-10  6.24057e-12  2.24315e-13  6.59107e-15  1.58313e-16  3.10841e-18  4.98911e-20  6.54592e-22  7.02072e-24  6.15538e-26  4.41154e-28  2.58457e-30  1.2378e-32   4.8459e-35   1.55082e-37  4.05705e-40  8.67605e-43  1.51669e-45  2.16738e-48  2.53183e-51  2.41767e-54  1.88722e-57  1.20423e-60  6.28148e-64  2.6784e-67   9.3358e-71   2.66005e-74  6.19572e-78  1.17966e-81   1.83605e-85   2.336e-89     2.42955e-93   2.06557e-97   1.43555e-101  8.15565e-106  3.78758e-110  1.4379e-114   4.46227e-119  1.132e-123    2.34748e-128  3.9794e-133   5.51438e-138  6.24653e-143  5.7842e-148\n 0.0265661     0.0804977     0.199389      0.403722      0.668229      0.904131      1.0           0.904131      0.668229      0.403722      0.199389      0.0804977     0.0265661     0.00716698    0.00158054    0.00028493    4.19889e-5   5.05816e-6   4.98097e-7   4.00957e-8   2.63842e-9   1.41923e-10  6.24057e-12  2.24315e-13  6.59107e-15  1.58313e-16  3.10841e-18  4.98911e-20  6.54592e-22  7.02072e-24  6.15538e-26  4.41154e-28  2.58457e-30  1.2378e-32   4.8459e-35   1.55082e-37  4.05705e-40  8.67605e-43  1.51669e-45  2.16738e-48  2.53183e-51  2.41767e-54  1.88722e-57  1.20423e-60  6.28148e-64  2.6784e-67   9.3358e-71   2.66005e-74  6.19572e-78   1.17966e-81   1.83605e-85   2.336e-89     2.42955e-93   2.06557e-97   1.43555e-101  8.15565e-106  3.78758e-110  1.4379e-114   4.46227e-119  1.132e-123    2.34748e-128  3.9794e-133   5.51438e-138  6.24653e-143\n 0.00716698    0.0265661     0.0804977     0.199389      0.403722      0.668229      0.904131      1.0           0.904131      0.668229      0.403722      0.199389      0.0804977     0.0265661     0.00716698    0.00158054    0.00028493   4.19889e-5   5.05816e-6   4.98097e-7   4.00957e-8   2.63842e-9   1.41923e-10  6.24057e-12  2.24315e-13  6.59107e-15  1.58313e-16  3.10841e-18  4.98911e-20  6.54592e-22  7.02072e-24  6.15538e-26  4.41154e-28  2.58457e-30  1.2378e-32   4.8459e-35   1.55082e-37  4.05705e-40  8.67605e-43  1.51669e-45  2.16738e-48  2.53183e-51  2.41767e-54  1.88722e-57  1.20423e-60  6.28148e-64  2.6784e-67   9.3358e-71   2.66005e-74   6.19572e-78   1.17966e-81   1.83605e-85   2.336e-89     2.42955e-93   2.06557e-97   1.43555e-101  8.15565e-106  3.78758e-110  1.4379e-114   4.46227e-119  1.132e-123    2.34748e-128  3.9794e-133   5.51438e-138\n 0.00158054    0.00716698    0.0265661     0.0804977     0.199389      0.403722      0.668229      0.904131      1.0           0.904131      0.668229      0.403722      0.199389      0.0804977     0.0265661     0.00716698    0.00158054   0.00028493   4.19889e-5   5.05816e-6   4.98097e-7   4.00957e-8   2.63842e-9   1.41923e-10  6.24057e-12  2.24315e-13  6.59107e-15  1.58313e-16  3.10841e-18  4.98911e-20  6.54592e-22  7.02072e-24  6.15538e-26  4.41154e-28  2.58457e-30  1.2378e-32   4.8459e-35   1.55082e-37  4.05705e-40  8.67605e-43  1.51669e-45  2.16738e-48  2.53183e-51  2.41767e-54  1.88722e-57  1.20423e-60  6.28148e-64  2.6784e-67   9.3358e-71    2.66005e-74   6.19572e-78   1.17966e-81   1.83605e-85   2.336e-89     2.42955e-93   2.06557e-97   1.43555e-101  8.15565e-106  3.78758e-110  1.4379e-114   4.46227e-119  1.132e-123    2.34748e-128  3.9794e-133\n 0.00028493    0.00158054    0.00716698    0.0265661     0.0804977     0.199389      0.403722      0.668229      0.904131      1.0           0.904131      0.668229      0.403722      0.199389      0.0804977     0.0265661     0.00716698   0.00158054   0.00028493   4.19889e-5   5.05816e-6   4.98097e-7   4.00957e-8   2.63842e-9   1.41923e-10  6.24057e-12  2.24315e-13  6.59107e-15  1.58313e-16  3.10841e-18  4.98911e-20  6.54592e-22  7.02072e-24  6.15538e-26  4.41154e-28  2.58457e-30  1.2378e-32   4.8459e-35   1.55082e-37  4.05705e-40  8.67605e-43  1.51669e-45  2.16738e-48  2.53183e-51  2.41767e-54  1.88722e-57  1.20423e-60  6.28148e-64  2.6784e-67    9.3358e-71    2.66005e-74   6.19572e-78   1.17966e-81   1.83605e-85   2.336e-89     2.42955e-93   2.06557e-97   1.43555e-101  8.15565e-106  3.78758e-110  1.4379e-114   4.46227e-119  1.132e-123    2.34748e-128\n 4.19889e-5    0.00028493    0.00158054    0.00716698    0.0265661     0.0804977     0.199389      0.403722      0.668229      0.904131      1.0           0.904131      0.668229      0.403722      0.199389      0.0804977     0.0265661    0.00716698   0.00158054   0.00028493   4.19889e-5   5.05816e-6   4.98097e-7   4.00957e-8   2.63842e-9   1.41923e-10  6.24057e-12  2.24315e-13  6.59107e-15  1.58313e-16  3.10841e-18  4.98911e-20  6.54592e-22  7.02072e-24  6.15538e-26  4.41154e-28  2.58457e-30  1.2378e-32   4.8459e-35   1.55082e-37  4.05705e-40  8.67605e-43  1.51669e-45  2.16738e-48  2.53183e-51  2.41767e-54  1.88722e-57  1.20423e-60  6.28148e-64   2.6784e-67    9.3358e-71    2.66005e-74   6.19572e-78   1.17966e-81   1.83605e-85   2.336e-89     2.42955e-93   2.06557e-97   1.43555e-101  8.15565e-106  3.78758e-110  1.4379e-114   4.46227e-119  1.132e-123\n 5.05816e-6    4.19889e-5    0.00028493    0.00158054    0.00716698    0.0265661     0.0804977     0.199389      0.403722      0.668229      0.904131      1.0           0.904131      0.668229      0.403722      0.199389      0.0804977    0.0265661    0.00716698   0.00158054   0.00028493   4.19889e-5   5.05816e-6   4.98097e-7   4.00957e-8   2.63842e-9   1.41923e-10  6.24057e-12  2.24315e-13  6.59107e-15  1.58313e-16  3.10841e-18  4.98911e-20  6.54592e-22  7.02072e-24  6.15538e-26  4.41154e-28  2.58457e-30  1.2378e-32   4.8459e-35   1.55082e-37  4.05705e-40  8.67605e-43  1.51669e-45  2.16738e-48  2.53183e-51  2.41767e-54  1.88722e-57  1.20423e-60   6.28148e-64   2.6784e-67    9.3358e-71    2.66005e-74   6.19572e-78   1.17966e-81   1.83605e-85   2.336e-89     2.42955e-93   2.06557e-97   1.43555e-101  8.15565e-106  3.78758e-110  1.4379e-114   4.46227e-119\n 4.98097e-7    5.05816e-6    4.19889e-5    0.00028493    0.00158054    0.00716698    0.0265661     0.0804977     0.199389      0.403722      0.668229      0.904131      1.0           0.904131      0.668229      0.403722      0.199389     0.0804977    0.0265661    0.00716698   0.00158054   0.00028493   4.19889e-5   5.05816e-6   4.98097e-7   4.00957e-8   2.63842e-9   1.41923e-10  6.24057e-12  2.24315e-13  6.59107e-15  1.58313e-16  3.10841e-18  4.98911e-20  6.54592e-22  7.02072e-24  6.15538e-26  4.41154e-28  2.58457e-30  1.2378e-32   4.8459e-35   1.55082e-37  4.05705e-40  8.67605e-43  1.51669e-45  2.16738e-48  2.53183e-51  2.41767e-54  1.88722e-57   1.20423e-60   6.28148e-64   2.6784e-67    9.3358e-71    2.66005e-74   6.19572e-78   1.17966e-81   1.83605e-85   2.336e-89     2.42955e-93   2.06557e-97   1.43555e-101  8.15565e-106  3.78758e-110  1.4379e-114\n 4.00957e-8    4.98097e-7    5.05816e-6    4.19889e-5    0.00028493    0.00158054    0.00716698    0.0265661     0.0804977     0.199389      0.403722      0.668229      0.904131      1.0           0.904131      0.668229      0.403722     0.199389     0.0804977    0.0265661    0.00716698   0.00158054   0.00028493   4.19889e-5   5.05816e-6   4.98097e-7   4.00957e-8   2.63842e-9   1.41923e-10  6.24057e-12  2.24315e-13  6.59107e-15  1.58313e-16  3.10841e-18  4.98911e-20  6.54592e-22  7.02072e-24  6.15538e-26  4.41154e-28  2.58457e-30  1.2378e-32   4.8459e-35   1.55082e-37  4.05705e-40  8.67605e-43  1.51669e-45  2.16738e-48  2.53183e-51  2.41767e-54   1.88722e-57   1.20423e-60   6.28148e-64   2.6784e-67    9.3358e-71    2.66005e-74   6.19572e-78   1.17966e-81   1.83605e-85   2.336e-89     2.42955e-93   2.06557e-97   1.43555e-101  8.15565e-106  3.78758e-110\n 2.63842e-9    4.00957e-8    4.98097e-7    5.05816e-6    4.19889e-5    0.00028493    0.00158054    0.00716698    0.0265661     0.0804977     0.199389      0.403722      0.668229      0.904131      1.0           0.904131      0.668229     0.403722     0.199389     0.0804977    0.0265661    0.00716698   0.00158054   0.00028493   4.19889e-5   5.05816e-6   4.98097e-7   4.00957e-8   2.63842e-9   1.41923e-10  6.24057e-12  2.24315e-13  6.59107e-15  1.58313e-16  3.10841e-18  4.98911e-20  6.54592e-22  7.02072e-24  6.15538e-26  4.41154e-28  2.58457e-30  1.2378e-32   4.8459e-35   1.55082e-37  4.05705e-40  8.67605e-43  1.51669e-45  2.16738e-48  2.53183e-51   2.41767e-54   1.88722e-57   1.20423e-60   6.28148e-64   2.6784e-67    9.3358e-71    2.66005e-74   6.19572e-78   1.17966e-81   1.83605e-85   2.336e-89     2.42955e-93   2.06557e-97   1.43555e-101  8.15565e-106\n 1.41923e-10   2.63842e-9    4.00957e-8    4.98097e-7    5.05816e-6    4.19889e-5    0.00028493    0.00158054    0.00716698    0.0265661     0.0804977     0.199389      0.403722      0.668229      0.904131      1.0           0.904131     0.668229     0.403722     0.199389     0.0804977    0.0265661    0.00716698   0.00158054   0.00028493   4.19889e-5   5.05816e-6   4.98097e-7   4.00957e-8   2.63842e-9   1.41923e-10  6.24057e-12  2.24315e-13  6.59107e-15  1.58313e-16  3.10841e-18  4.98911e-20  6.54592e-22  7.02072e-24  6.15538e-26  4.41154e-28  2.58457e-30  1.2378e-32   4.8459e-35   1.55082e-37  4.05705e-40  8.67605e-43  1.51669e-45  2.16738e-48   2.53183e-51   2.41767e-54   1.88722e-57   1.20423e-60   6.28148e-64   2.6784e-67    9.3358e-71    2.66005e-74   6.19572e-78   1.17966e-81   1.83605e-85   2.336e-89     2.42955e-93   2.06557e-97   1.43555e-101\n 6.24057e-12   1.41923e-10   2.63842e-9    4.00957e-8    4.98097e-7    5.05816e-6    4.19889e-5    0.00028493    0.00158054    0.00716698    0.0265661     0.0804977     0.199389      0.403722      0.668229      0.904131      1.0          0.904131     0.668229     0.403722     0.199389     0.0804977    0.0265661    0.00716698   0.00158054   0.00028493   4.19889e-5   5.05816e-6   4.98097e-7   4.00957e-8   2.63842e-9   1.41923e-10  6.24057e-12  2.24315e-13  6.59107e-15  1.58313e-16  3.10841e-18  4.98911e-20  6.54592e-22  7.02072e-24  6.15538e-26  4.41154e-28  2.58457e-30  1.2378e-32   4.8459e-35   1.55082e-37  4.05705e-40  8.67605e-43  1.51669e-45   2.16738e-48   2.53183e-51   2.41767e-54   1.88722e-57   1.20423e-60   6.28148e-64   2.6784e-67    9.3358e-71    2.66005e-74   6.19572e-78   1.17966e-81   1.83605e-85   2.336e-89     2.42955e-93   2.06557e-97\n 2.24315e-13   6.24057e-12   1.41923e-10   2.63842e-9    4.00957e-8    4.98097e-7    5.05816e-6    4.19889e-5    0.00028493    0.00158054    0.00716698    0.0265661     0.0804977     0.199389      0.403722      0.668229      0.904131     1.0          0.904131     0.668229     0.403722     0.199389     0.0804977    0.0265661    0.00716698   0.00158054   0.00028493   4.19889e-5   5.05816e-6   4.98097e-7   4.00957e-8   2.63842e-9   1.41923e-10  6.24057e-12  2.24315e-13  6.59107e-15  1.58313e-16  3.10841e-18  4.98911e-20  6.54592e-22  7.02072e-24  6.15538e-26  4.41154e-28  2.58457e-30  1.2378e-32   4.8459e-35   1.55082e-37  4.05705e-40  8.67605e-43   1.51669e-45   2.16738e-48   2.53183e-51   2.41767e-54   1.88722e-57   1.20423e-60   6.28148e-64   2.6784e-67    9.3358e-71    2.66005e-74   6.19572e-78   1.17966e-81   1.83605e-85   2.336e-89     2.42955e-93\n 6.59107e-15   2.24315e-13   6.24057e-12   1.41923e-10   2.63842e-9    4.00957e-8    4.98097e-7    5.05816e-6    4.19889e-5    0.00028493    0.00158054    0.00716698    0.0265661     0.0804977     0.199389      0.403722      0.668229     0.904131     1.0          0.904131     0.668229     0.403722     0.199389     0.0804977    0.0265661    0.00716698   0.00158054   0.00028493   4.19889e-5   5.05816e-6   4.98097e-7   4.00957e-8   2.63842e-9   1.41923e-10  6.24057e-12  2.24315e-13  6.59107e-15  1.58313e-16  3.10841e-18  4.98911e-20  6.54592e-22  7.02072e-24  6.15538e-26  4.41154e-28  2.58457e-30  1.2378e-32   4.8459e-35   1.55082e-37  4.05705e-40   8.67605e-43   1.51669e-45   2.16738e-48   2.53183e-51   2.41767e-54   1.88722e-57   1.20423e-60   6.28148e-64   2.6784e-67    9.3358e-71    2.66005e-74   6.19572e-78   1.17966e-81   1.83605e-85   2.336e-89\n 1.58313e-16   6.59107e-15   2.24315e-13   6.24057e-12   1.41923e-10   2.63842e-9    4.00957e-8    4.98097e-7    5.05816e-6    4.19889e-5    0.00028493    0.00158054    0.00716698    0.0265661     0.0804977     0.199389      0.403722     0.668229     0.904131     1.0          0.904131     0.668229     0.403722     0.199389     0.0804977    0.0265661    0.00716698   0.00158054   0.00028493   4.19889e-5   5.05816e-6   4.98097e-7   4.00957e-8   2.63842e-9   1.41923e-10  6.24057e-12  2.24315e-13  6.59107e-15  1.58313e-16  3.10841e-18  4.98911e-20  6.54592e-22  7.02072e-24  6.15538e-26  4.41154e-28  2.58457e-30  1.2378e-32   4.8459e-35   1.55082e-37   4.05705e-40   8.67605e-43   1.51669e-45   2.16738e-48   2.53183e-51   2.41767e-54   1.88722e-57   1.20423e-60   6.28148e-64   2.6784e-67    9.3358e-71    2.66005e-74   6.19572e-78   1.17966e-81   1.83605e-85\n 3.10841e-18   1.58313e-16   6.59107e-15   2.24315e-13   6.24057e-12   1.41923e-10   2.63842e-9    4.00957e-8    4.98097e-7    5.05816e-6    4.19889e-5    0.00028493    0.00158054    0.00716698    0.0265661     0.0804977     0.199389     0.403722     0.668229     0.904131     1.0          0.904131     0.668229     0.403722     0.199389     0.0804977    0.0265661    0.00716698   0.00158054   0.00028493   4.19889e-5   5.05816e-6   4.98097e-7   4.00957e-8   2.63842e-9   1.41923e-10  6.24057e-12  2.24315e-13  6.59107e-15  1.58313e-16  3.10841e-18  4.98911e-20  6.54592e-22  7.02072e-24  6.15538e-26  4.41154e-28  2.58457e-30  1.2378e-32   4.8459e-35    1.55082e-37   4.05705e-40   8.67605e-43   1.51669e-45   2.16738e-48   2.53183e-51   2.41767e-54   1.88722e-57   1.20423e-60   6.28148e-64   2.6784e-67    9.3358e-71    2.66005e-74   6.19572e-78   1.17966e-81\n 4.98911e-20   3.10841e-18   1.58313e-16   6.59107e-15   2.24315e-13   6.24057e-12   1.41923e-10   2.63842e-9    4.00957e-8    4.98097e-7    5.05816e-6    4.19889e-5    0.00028493    0.00158054    0.00716698    0.0265661     0.0804977    0.199389     0.403722     0.668229     0.904131     1.0          0.904131     0.668229     0.403722     0.199389     0.0804977    0.0265661    0.00716698   0.00158054   0.00028493   4.19889e-5   5.05816e-6   4.98097e-7   4.00957e-8   2.63842e-9   1.41923e-10  6.24057e-12  2.24315e-13  6.59107e-15  1.58313e-16  3.10841e-18  4.98911e-20  6.54592e-22  7.02072e-24  6.15538e-26  4.41154e-28  2.58457e-30  1.2378e-32    4.8459e-35    1.55082e-37   4.05705e-40   8.67605e-43   1.51669e-45   2.16738e-48   2.53183e-51   2.41767e-54   1.88722e-57   1.20423e-60   6.28148e-64   2.6784e-67    9.3358e-71    2.66005e-74   6.19572e-78\n 6.54592e-22   4.98911e-20   3.10841e-18   1.58313e-16   6.59107e-15   2.24315e-13   6.24057e-12   1.41923e-10   2.63842e-9    4.00957e-8    4.98097e-7    5.05816e-6    4.19889e-5    0.00028493    0.00158054    0.00716698    0.0265661    0.0804977    0.199389     0.403722     0.668229     0.904131     1.0          0.904131     0.668229     0.403722     0.199389     0.0804977    0.0265661    0.00716698   0.00158054   0.00028493   4.19889e-5   5.05816e-6   4.98097e-7   4.00957e-8   2.63842e-9   1.41923e-10  6.24057e-12  2.24315e-13  6.59107e-15  1.58313e-16  3.10841e-18  4.98911e-20  6.54592e-22  7.02072e-24  6.15538e-26  4.41154e-28  2.58457e-30   1.2378e-32    4.8459e-35    1.55082e-37   4.05705e-40   8.67605e-43   1.51669e-45   2.16738e-48   2.53183e-51   2.41767e-54   1.88722e-57   1.20423e-60   6.28148e-64   2.6784e-67    9.3358e-71    2.66005e-74\n 7.02072e-24   6.54592e-22   4.98911e-20   3.10841e-18   1.58313e-16   6.59107e-15   2.24315e-13   6.24057e-12   1.41923e-10   2.63842e-9    4.00957e-8    4.98097e-7    5.05816e-6    4.19889e-5    0.00028493    0.00158054    0.00716698   0.0265661    0.0804977    0.199389     0.403722     0.668229     0.904131     1.0          0.904131     0.668229     0.403722     0.199389     0.0804977    0.0265661    0.00716698   0.00158054   0.00028493   4.19889e-5   5.05816e-6   4.98097e-7   4.00957e-8   2.63842e-9   1.41923e-10  6.24057e-12  2.24315e-13  6.59107e-15  1.58313e-16  3.10841e-18  4.98911e-20  6.54592e-22  7.02072e-24  6.15538e-26  4.41154e-28   2.58457e-30   1.2378e-32    4.8459e-35    1.55082e-37   4.05705e-40   8.67605e-43   1.51669e-45   2.16738e-48   2.53183e-51   2.41767e-54   1.88722e-57   1.20423e-60   6.28148e-64   2.6784e-67    9.3358e-71\n 6.15538e-26   7.02072e-24   6.54592e-22   4.98911e-20   3.10841e-18   1.58313e-16   6.59107e-15   2.24315e-13   6.24057e-12   1.41923e-10   2.63842e-9    4.00957e-8    4.98097e-7    5.05816e-6    4.19889e-5    0.00028493    0.00158054   0.00716698   0.0265661    0.0804977    0.199389     0.403722     0.668229     0.904131     1.0          0.904131     0.668229     0.403722     0.199389     0.0804977    0.0265661    0.00716698   0.00158054   0.00028493   4.19889e-5   5.05816e-6   4.98097e-7   4.00957e-8   2.63842e-9   1.41923e-10  6.24057e-12  2.24315e-13  6.59107e-15  1.58313e-16  3.10841e-18  4.98911e-20  6.54592e-22  7.02072e-24  6.15538e-26   4.41154e-28   2.58457e-30   1.2378e-32    4.8459e-35    1.55082e-37   4.05705e-40   8.67605e-43   1.51669e-45   2.16738e-48   2.53183e-51   2.41767e-54   1.88722e-57   1.20423e-60   6.28148e-64   2.6784e-67\n 4.41154e-28   6.15538e-26   7.02072e-24   6.54592e-22   4.98911e-20   3.10841e-18   1.58313e-16   6.59107e-15   2.24315e-13   6.24057e-12   1.41923e-10   2.63842e-9    4.00957e-8    4.98097e-7    5.05816e-6    4.19889e-5    0.00028493   0.00158054   0.00716698   0.0265661    0.0804977    0.199389     0.403722     0.668229     0.904131     1.0          0.904131     0.668229     0.403722     0.199389     0.0804977    0.0265661    0.00716698   0.00158054   0.00028493   4.19889e-5   5.05816e-6   4.98097e-7   4.00957e-8   2.63842e-9   1.41923e-10  6.24057e-12  2.24315e-13  6.59107e-15  1.58313e-16  3.10841e-18  4.98911e-20  6.54592e-22  7.02072e-24   6.15538e-26   4.41154e-28   2.58457e-30   1.2378e-32    4.8459e-35    1.55082e-37   4.05705e-40   8.67605e-43   1.51669e-45   2.16738e-48   2.53183e-51   2.41767e-54   1.88722e-57   1.20423e-60   6.28148e-64\n 2.58457e-30   4.41154e-28   6.15538e-26   7.02072e-24   6.54592e-22   4.98911e-20   3.10841e-18   1.58313e-16   6.59107e-15   2.24315e-13   6.24057e-12   1.41923e-10   2.63842e-9    4.00957e-8    4.98097e-7    5.05816e-6    4.19889e-5   0.00028493   0.00158054   0.00716698   0.0265661    0.0804977    0.199389     0.403722     0.668229     0.904131     1.0          0.904131     0.668229     0.403722     0.199389     0.0804977    0.0265661    0.00716698   0.00158054   0.00028493   4.19889e-5   5.05816e-6   4.98097e-7   4.00957e-8   2.63842e-9   1.41923e-10  6.24057e-12  2.24315e-13  6.59107e-15  1.58313e-16  3.10841e-18  4.98911e-20  6.54592e-22   7.02072e-24   6.15538e-26   4.41154e-28   2.58457e-30   1.2378e-32    4.8459e-35    1.55082e-37   4.05705e-40   8.67605e-43   1.51669e-45   2.16738e-48   2.53183e-51   2.41767e-54   1.88722e-57   1.20423e-60\n 1.2378e-32    2.58457e-30   4.41154e-28   6.15538e-26   7.02072e-24   6.54592e-22   4.98911e-20   3.10841e-18   1.58313e-16   6.59107e-15   2.24315e-13   6.24057e-12   1.41923e-10   2.63842e-9    4.00957e-8    4.98097e-7    5.05816e-6   4.19889e-5   0.00028493   0.00158054   0.00716698   0.0265661    0.0804977    0.199389     0.403722     0.668229     0.904131     1.0          0.904131     0.668229     0.403722     0.199389     0.0804977    0.0265661    0.00716698   0.00158054   0.00028493   4.19889e-5   5.05816e-6   4.98097e-7   4.00957e-8   2.63842e-9   1.41923e-10  6.24057e-12  2.24315e-13  6.59107e-15  1.58313e-16  3.10841e-18  4.98911e-20   6.54592e-22   7.02072e-24   6.15538e-26   4.41154e-28   2.58457e-30   1.2378e-32    4.8459e-35    1.55082e-37   4.05705e-40   8.67605e-43   1.51669e-45   2.16738e-48   2.53183e-51   2.41767e-54   1.88722e-57\n 4.8459e-35    1.2378e-32    2.58457e-30   4.41154e-28   6.15538e-26   7.02072e-24   6.54592e-22   4.98911e-20   3.10841e-18   1.58313e-16   6.59107e-15   2.24315e-13   6.24057e-12   1.41923e-10   2.63842e-9    4.00957e-8    4.98097e-7   5.05816e-6   4.19889e-5   0.00028493   0.00158054   0.00716698   0.0265661    0.0804977    0.199389     0.403722     0.668229     0.904131     1.0          0.904131     0.668229     0.403722     0.199389     0.0804977    0.0265661    0.00716698   0.00158054   0.00028493   4.19889e-5   5.05816e-6   4.98097e-7   4.00957e-8   2.63842e-9   1.41923e-10  6.24057e-12  2.24315e-13  6.59107e-15  1.58313e-16  3.10841e-18   4.98911e-20   6.54592e-22   7.02072e-24   6.15538e-26   4.41154e-28   2.58457e-30   1.2378e-32    4.8459e-35    1.55082e-37   4.05705e-40   8.67605e-43   1.51669e-45   2.16738e-48   2.53183e-51   2.41767e-54\n 1.55082e-37   4.8459e-35    1.2378e-32    2.58457e-30   4.41154e-28   6.15538e-26   7.02072e-24   6.54592e-22   4.98911e-20   3.10841e-18   1.58313e-16   6.59107e-15   2.24315e-13   6.24057e-12   1.41923e-10   2.63842e-9    4.00957e-8   4.98097e-7   5.05816e-6   4.19889e-5   0.00028493   0.00158054   0.00716698   0.0265661    0.0804977    0.199389     0.403722     0.668229     0.904131     1.0          0.904131     0.668229     0.403722     0.199389     0.0804977    0.0265661    0.00716698   0.00158054   0.00028493   4.19889e-5   5.05816e-6   4.98097e-7   4.00957e-8   2.63842e-9   1.41923e-10  6.24057e-12  2.24315e-13  6.59107e-15  1.58313e-16   3.10841e-18   4.98911e-20   6.54592e-22   7.02072e-24   6.15538e-26   4.41154e-28   2.58457e-30   1.2378e-32    4.8459e-35    1.55082e-37   4.05705e-40   8.67605e-43   1.51669e-45   2.16738e-48   2.53183e-51\n 4.05705e-40   1.55082e-37   4.8459e-35    1.2378e-32    2.58457e-30   4.41154e-28   6.15538e-26   7.02072e-24   6.54592e-22   4.98911e-20   3.10841e-18   1.58313e-16   6.59107e-15   2.24315e-13   6.24057e-12   1.41923e-10   2.63842e-9   4.00957e-8   4.98097e-7   5.05816e-6   4.19889e-5   0.00028493   0.00158054   0.00716698   0.0265661    0.0804977    0.199389     0.403722     0.668229     0.904131     1.0          0.904131     0.668229     0.403722     0.199389     0.0804977    0.0265661    0.00716698   0.00158054   0.00028493   4.19889e-5   5.05816e-6   4.98097e-7   4.00957e-8   2.63842e-9   1.41923e-10  6.24057e-12  2.24315e-13  6.59107e-15   1.58313e-16   3.10841e-18   4.98911e-20   6.54592e-22   7.02072e-24   6.15538e-26   4.41154e-28   2.58457e-30   1.2378e-32    4.8459e-35    1.55082e-37   4.05705e-40   8.67605e-43   1.51669e-45   2.16738e-48\n 8.67605e-43   4.05705e-40   1.55082e-37   4.8459e-35    1.2378e-32    2.58457e-30   4.41154e-28   6.15538e-26   7.02072e-24   6.54592e-22   4.98911e-20   3.10841e-18   1.58313e-16   6.59107e-15   2.24315e-13   6.24057e-12   1.41923e-10  2.63842e-9   4.00957e-8   4.98097e-7   5.05816e-6   4.19889e-5   0.00028493   0.00158054   0.00716698   0.0265661    0.0804977    0.199389     0.403722     0.668229     0.904131     1.0          0.904131     0.668229     0.403722     0.199389     0.0804977    0.0265661    0.00716698   0.00158054   0.00028493   4.19889e-5   5.05816e-6   4.98097e-7   4.00957e-8   2.63842e-9   1.41923e-10  6.24057e-12  2.24315e-13   6.59107e-15   1.58313e-16   3.10841e-18   4.98911e-20   6.54592e-22   7.02072e-24   6.15538e-26   4.41154e-28   2.58457e-30   1.2378e-32    4.8459e-35    1.55082e-37   4.05705e-40   8.67605e-43   1.51669e-45\n 1.51669e-45   8.67605e-43   4.05705e-40   1.55082e-37   4.8459e-35    1.2378e-32    2.58457e-30   4.41154e-28   6.15538e-26   7.02072e-24   6.54592e-22   4.98911e-20   3.10841e-18   1.58313e-16   6.59107e-15   2.24315e-13   6.24057e-12  1.41923e-10  2.63842e-9   4.00957e-8   4.98097e-7   5.05816e-6   4.19889e-5   0.00028493   0.00158054   0.00716698   0.0265661    0.0804977    0.199389     0.403722     0.668229     0.904131     1.0          0.904131     0.668229     0.403722     0.199389     0.0804977    0.0265661    0.00716698   0.00158054   0.00028493   4.19889e-5   5.05816e-6   4.98097e-7   4.00957e-8   2.63842e-9   1.41923e-10  6.24057e-12   2.24315e-13   6.59107e-15   1.58313e-16   3.10841e-18   4.98911e-20   6.54592e-22   7.02072e-24   6.15538e-26   4.41154e-28   2.58457e-30   1.2378e-32    4.8459e-35    1.55082e-37   4.05705e-40   8.67605e-43\n 2.16738e-48   1.51669e-45   8.67605e-43   4.05705e-40   1.55082e-37   4.8459e-35    1.2378e-32    2.58457e-30   4.41154e-28   6.15538e-26   7.02072e-24   6.54592e-22   4.98911e-20   3.10841e-18   1.58313e-16   6.59107e-15   2.24315e-13  6.24057e-12  1.41923e-10  2.63842e-9   4.00957e-8   4.98097e-7   5.05816e-6   4.19889e-5   0.00028493   0.00158054   0.00716698   0.0265661    0.0804977    0.199389     0.403722     0.668229     0.904131     1.0          0.904131     0.668229     0.403722     0.199389     0.0804977    0.0265661    0.00716698   0.00158054   0.00028493   4.19889e-5   5.05816e-6   4.98097e-7   4.00957e-8   2.63842e-9   1.41923e-10   6.24057e-12   2.24315e-13   6.59107e-15   1.58313e-16   3.10841e-18   4.98911e-20   6.54592e-22   7.02072e-24   6.15538e-26   4.41154e-28   2.58457e-30   1.2378e-32    4.8459e-35    1.55082e-37   4.05705e-40\n 2.53183e-51   2.16738e-48   1.51669e-45   8.67605e-43   4.05705e-40   1.55082e-37   4.8459e-35    1.2378e-32    2.58457e-30   4.41154e-28   6.15538e-26   7.02072e-24   6.54592e-22   4.98911e-20   3.10841e-18   1.58313e-16   6.59107e-15  2.24315e-13  6.24057e-12  1.41923e-10  2.63842e-9   4.00957e-8   4.98097e-7   5.05816e-6   4.19889e-5   0.00028493   0.00158054   0.00716698   0.0265661    0.0804977    0.199389     0.403722     0.668229     0.904131     1.0          0.904131     0.668229     0.403722     0.199389     0.0804977    0.0265661    0.00716698   0.00158054   0.00028493   4.19889e-5   5.05816e-6   4.98097e-7   4.00957e-8   2.63842e-9    1.41923e-10   6.24057e-12   2.24315e-13   6.59107e-15   1.58313e-16   3.10841e-18   4.98911e-20   6.54592e-22   7.02072e-24   6.15538e-26   4.41154e-28   2.58457e-30   1.2378e-32    4.8459e-35    1.55082e-37\n 2.41767e-54   2.53183e-51   2.16738e-48   1.51669e-45   8.67605e-43   4.05705e-40   1.55082e-37   4.8459e-35    1.2378e-32    2.58457e-30   4.41154e-28   6.15538e-26   7.02072e-24   6.54592e-22   4.98911e-20   3.10841e-18   1.58313e-16  6.59107e-15  2.24315e-13  6.24057e-12  1.41923e-10  2.63842e-9   4.00957e-8   4.98097e-7   5.05816e-6   4.19889e-5   0.00028493   0.00158054   0.00716698   0.0265661    0.0804977    0.199389     0.403722     0.668229     0.904131     1.0          0.904131     0.668229     0.403722     0.199389     0.0804977    0.0265661    0.00716698   0.00158054   0.00028493   4.19889e-5   5.05816e-6   4.98097e-7   4.00957e-8    2.63842e-9    1.41923e-10   6.24057e-12   2.24315e-13   6.59107e-15   1.58313e-16   3.10841e-18   4.98911e-20   6.54592e-22   7.02072e-24   6.15538e-26   4.41154e-28   2.58457e-30   1.2378e-32    4.8459e-35\n 1.88722e-57   2.41767e-54   2.53183e-51   2.16738e-48   1.51669e-45   8.67605e-43   4.05705e-40   1.55082e-37   4.8459e-35    1.2378e-32    2.58457e-30   4.41154e-28   6.15538e-26   7.02072e-24   6.54592e-22   4.98911e-20   3.10841e-18  1.58313e-16  6.59107e-15  2.24315e-13  6.24057e-12  1.41923e-10  2.63842e-9   4.00957e-8   4.98097e-7   5.05816e-6   4.19889e-5   0.00028493   0.00158054   0.00716698   0.0265661    0.0804977    0.199389     0.403722     0.668229     0.904131     1.0          0.904131     0.668229     0.403722     0.199389     0.0804977    0.0265661    0.00716698   0.00158054   0.00028493   4.19889e-5   5.05816e-6   4.98097e-7    4.00957e-8    2.63842e-9    1.41923e-10   6.24057e-12   2.24315e-13   6.59107e-15   1.58313e-16   3.10841e-18   4.98911e-20   6.54592e-22   7.02072e-24   6.15538e-26   4.41154e-28   2.58457e-30   1.2378e-32\n 1.20423e-60   1.88722e-57   2.41767e-54   2.53183e-51   2.16738e-48   1.51669e-45   8.67605e-43   4.05705e-40   1.55082e-37   4.8459e-35    1.2378e-32    2.58457e-30   4.41154e-28   6.15538e-26   7.02072e-24   6.54592e-22   4.98911e-20  3.10841e-18  1.58313e-16  6.59107e-15  2.24315e-13  6.24057e-12  1.41923e-10  2.63842e-9   4.00957e-8   4.98097e-7   5.05816e-6   4.19889e-5   0.00028493   0.00158054   0.00716698   0.0265661    0.0804977    0.199389     0.403722     0.668229     0.904131     1.0          0.904131     0.668229     0.403722     0.199389     0.0804977    0.0265661    0.00716698   0.00158054   0.00028493   4.19889e-5   5.05816e-6    4.98097e-7    4.00957e-8    2.63842e-9    1.41923e-10   6.24057e-12   2.24315e-13   6.59107e-15   1.58313e-16   3.10841e-18   4.98911e-20   6.54592e-22   7.02072e-24   6.15538e-26   4.41154e-28   2.58457e-30\n 6.28148e-64   1.20423e-60   1.88722e-57   2.41767e-54   2.53183e-51   2.16738e-48   1.51669e-45   8.67605e-43   4.05705e-40   1.55082e-37   4.8459e-35    1.2378e-32    2.58457e-30   4.41154e-28   6.15538e-26   7.02072e-24   6.54592e-22  4.98911e-20  3.10841e-18  1.58313e-16  6.59107e-15  2.24315e-13  6.24057e-12  1.41923e-10  2.63842e-9   4.00957e-8   4.98097e-7   5.05816e-6   4.19889e-5   0.00028493   0.00158054   0.00716698   0.0265661    0.0804977    0.199389     0.403722     0.668229     0.904131     1.0          0.904131     0.668229     0.403722     0.199389     0.0804977    0.0265661    0.00716698   0.00158054   0.00028493   4.19889e-5    5.05816e-6    4.98097e-7    4.00957e-8    2.63842e-9    1.41923e-10   6.24057e-12   2.24315e-13   6.59107e-15   1.58313e-16   3.10841e-18   4.98911e-20   6.54592e-22   7.02072e-24   6.15538e-26   4.41154e-28\n 2.6784e-67    6.28148e-64   1.20423e-60   1.88722e-57   2.41767e-54   2.53183e-51   2.16738e-48   1.51669e-45   8.67605e-43   4.05705e-40   1.55082e-37   4.8459e-35    1.2378e-32    2.58457e-30   4.41154e-28   6.15538e-26   7.02072e-24  6.54592e-22  4.98911e-20  3.10841e-18  1.58313e-16  6.59107e-15  2.24315e-13  6.24057e-12  1.41923e-10  2.63842e-9   4.00957e-8   4.98097e-7   5.05816e-6   4.19889e-5   0.00028493   0.00158054   0.00716698   0.0265661    0.0804977    0.199389     0.403722     0.668229     0.904131     1.0          0.904131     0.668229     0.403722     0.199389     0.0804977    0.0265661    0.00716698   0.00158054   0.00028493    4.19889e-5    5.05816e-6    4.98097e-7    4.00957e-8    2.63842e-9    1.41923e-10   6.24057e-12   2.24315e-13   6.59107e-15   1.58313e-16   3.10841e-18   4.98911e-20   6.54592e-22   7.02072e-24   6.15538e-26\n 9.3358e-71    2.6784e-67    6.28148e-64   1.20423e-60   1.88722e-57   2.41767e-54   2.53183e-51   2.16738e-48   1.51669e-45   8.67605e-43   4.05705e-40   1.55082e-37   4.8459e-35    1.2378e-32    2.58457e-30   4.41154e-28   6.15538e-26  7.02072e-24  6.54592e-22  4.98911e-20  3.10841e-18  1.58313e-16  6.59107e-15  2.24315e-13  6.24057e-12  1.41923e-10  2.63842e-9   4.00957e-8   4.98097e-7   5.05816e-6   4.19889e-5   0.00028493   0.00158054   0.00716698   0.0265661    0.0804977    0.199389     0.403722     0.668229     0.904131     1.0          0.904131     0.668229     0.403722     0.199389     0.0804977    0.0265661    0.00716698   0.00158054    0.00028493    4.19889e-5    5.05816e-6    4.98097e-7    4.00957e-8    2.63842e-9    1.41923e-10   6.24057e-12   2.24315e-13   6.59107e-15   1.58313e-16   3.10841e-18   4.98911e-20   6.54592e-22   7.02072e-24\n 2.66005e-74   9.3358e-71    2.6784e-67    6.28148e-64   1.20423e-60   1.88722e-57   2.41767e-54   2.53183e-51   2.16738e-48   1.51669e-45   8.67605e-43   4.05705e-40   1.55082e-37   4.8459e-35    1.2378e-32    2.58457e-30   4.41154e-28  6.15538e-26  7.02072e-24  6.54592e-22  4.98911e-20  3.10841e-18  1.58313e-16  6.59107e-15  2.24315e-13  6.24057e-12  1.41923e-10  2.63842e-9   4.00957e-8   4.98097e-7   5.05816e-6   4.19889e-5   0.00028493   0.00158054   0.00716698   0.0265661    0.0804977    0.199389     0.403722     0.668229     0.904131     1.0          0.904131     0.668229     0.403722     0.199389     0.0804977    0.0265661    0.00716698    0.00158054    0.00028493    4.19889e-5    5.05816e-6    4.98097e-7    4.00957e-8    2.63842e-9    1.41923e-10   6.24057e-12   2.24315e-13   6.59107e-15   1.58313e-16   3.10841e-18   4.98911e-20   6.54592e-22\n 6.19572e-78   2.66005e-74   9.3358e-71    2.6784e-67    6.28148e-64   1.20423e-60   1.88722e-57   2.41767e-54   2.53183e-51   2.16738e-48   1.51669e-45   8.67605e-43   4.05705e-40   1.55082e-37   4.8459e-35    1.2378e-32    2.58457e-30  4.41154e-28  6.15538e-26  7.02072e-24  6.54592e-22  4.98911e-20  3.10841e-18  1.58313e-16  6.59107e-15  2.24315e-13  6.24057e-12  1.41923e-10  2.63842e-9   4.00957e-8   4.98097e-7   5.05816e-6   4.19889e-5   0.00028493   0.00158054   0.00716698   0.0265661    0.0804977    0.199389     0.403722     0.668229     0.904131     1.0          0.904131     0.668229     0.403722     0.199389     0.0804977    0.0265661     0.00716698    0.00158054    0.00028493    4.19889e-5    5.05816e-6    4.98097e-7    4.00957e-8    2.63842e-9    1.41923e-10   6.24057e-12   2.24315e-13   6.59107e-15   1.58313e-16   3.10841e-18   4.98911e-20\n 1.17966e-81   6.19572e-78   2.66005e-74   9.3358e-71    2.6784e-67    6.28148e-64   1.20423e-60   1.88722e-57   2.41767e-54   2.53183e-51   2.16738e-48   1.51669e-45   8.67605e-43   4.05705e-40   1.55082e-37   4.8459e-35    1.2378e-32   2.58457e-30  4.41154e-28  6.15538e-26  7.02072e-24  6.54592e-22  4.98911e-20  3.10841e-18  1.58313e-16  6.59107e-15  2.24315e-13  6.24057e-12  1.41923e-10  2.63842e-9   4.00957e-8   4.98097e-7   5.05816e-6   4.19889e-5   0.00028493   0.00158054   0.00716698   0.0265661    0.0804977    0.199389     0.403722     0.668229     0.904131     1.0          0.904131     0.668229     0.403722     0.199389     0.0804977     0.0265661     0.00716698    0.00158054    0.00028493    4.19889e-5    5.05816e-6    4.98097e-7    4.00957e-8    2.63842e-9    1.41923e-10   6.24057e-12   2.24315e-13   6.59107e-15   1.58313e-16   3.10841e-18\n 1.83605e-85   1.17966e-81   6.19572e-78   2.66005e-74   9.3358e-71    2.6784e-67    6.28148e-64   1.20423e-60   1.88722e-57   2.41767e-54   2.53183e-51   2.16738e-48   1.51669e-45   8.67605e-43   4.05705e-40   1.55082e-37   4.8459e-35   1.2378e-32   2.58457e-30  4.41154e-28  6.15538e-26  7.02072e-24  6.54592e-22  4.98911e-20  3.10841e-18  1.58313e-16  6.59107e-15  2.24315e-13  6.24057e-12  1.41923e-10  2.63842e-9   4.00957e-8   4.98097e-7   5.05816e-6   4.19889e-5   0.00028493   0.00158054   0.00716698   0.0265661    0.0804977    0.199389     0.403722     0.668229     0.904131     1.0          0.904131     0.668229     0.403722     0.199389      0.0804977     0.0265661     0.00716698    0.00158054    0.00028493    4.19889e-5    5.05816e-6    4.98097e-7    4.00957e-8    2.63842e-9    1.41923e-10   6.24057e-12   2.24315e-13   6.59107e-15   1.58313e-16\n 2.336e-89     1.83605e-85   1.17966e-81   6.19572e-78   2.66005e-74   9.3358e-71    2.6784e-67    6.28148e-64   1.20423e-60   1.88722e-57   2.41767e-54   2.53183e-51   2.16738e-48   1.51669e-45   8.67605e-43   4.05705e-40   1.55082e-37  4.8459e-35   1.2378e-32   2.58457e-30  4.41154e-28  6.15538e-26  7.02072e-24  6.54592e-22  4.98911e-20  3.10841e-18  1.58313e-16  6.59107e-15  2.24315e-13  6.24057e-12  1.41923e-10  2.63842e-9   4.00957e-8   4.98097e-7   5.05816e-6   4.19889e-5   0.00028493   0.00158054   0.00716698   0.0265661    0.0804977    0.199389     0.403722     0.668229     0.904131     1.0          0.904131     0.668229     0.403722      0.199389      0.0804977     0.0265661     0.00716698    0.00158054    0.00028493    4.19889e-5    5.05816e-6    4.98097e-7    4.00957e-8    2.63842e-9    1.41923e-10   6.24057e-12   2.24315e-13   6.59107e-15\n 2.42955e-93   2.336e-89     1.83605e-85   1.17966e-81   6.19572e-78   2.66005e-74   9.3358e-71    2.6784e-67    6.28148e-64   1.20423e-60   1.88722e-57   2.41767e-54   2.53183e-51   2.16738e-48   1.51669e-45   8.67605e-43   4.05705e-40  1.55082e-37  4.8459e-35   1.2378e-32   2.58457e-30  4.41154e-28  6.15538e-26  7.02072e-24  6.54592e-22  4.98911e-20  3.10841e-18  1.58313e-16  6.59107e-15  2.24315e-13  6.24057e-12  1.41923e-10  2.63842e-9   4.00957e-8   4.98097e-7   5.05816e-6   4.19889e-5   0.00028493   0.00158054   0.00716698   0.0265661    0.0804977    0.199389     0.403722     0.668229     0.904131     1.0          0.904131     0.668229      0.403722      0.199389      0.0804977     0.0265661     0.00716698    0.00158054    0.00028493    4.19889e-5    5.05816e-6    4.98097e-7    4.00957e-8    2.63842e-9    1.41923e-10   6.24057e-12   2.24315e-13\n 2.06557e-97   2.42955e-93   2.336e-89     1.83605e-85   1.17966e-81   6.19572e-78   2.66005e-74   9.3358e-71    2.6784e-67    6.28148e-64   1.20423e-60   1.88722e-57   2.41767e-54   2.53183e-51   2.16738e-48   1.51669e-45   8.67605e-43  4.05705e-40  1.55082e-37  4.8459e-35   1.2378e-32   2.58457e-30  4.41154e-28  6.15538e-26  7.02072e-24  6.54592e-22  4.98911e-20  3.10841e-18  1.58313e-16  6.59107e-15  2.24315e-13  6.24057e-12  1.41923e-10  2.63842e-9   4.00957e-8   4.98097e-7   5.05816e-6   4.19889e-5   0.00028493   0.00158054   0.00716698   0.0265661    0.0804977    0.199389     0.403722     0.668229     0.904131     1.0          0.904131      0.668229      0.403722      0.199389      0.0804977     0.0265661     0.00716698    0.00158054    0.00028493    4.19889e-5    5.05816e-6    4.98097e-7    4.00957e-8    2.63842e-9    1.41923e-10   6.24057e-12\n 1.43555e-101  2.06557e-97   2.42955e-93   2.336e-89     1.83605e-85   1.17966e-81   6.19572e-78   2.66005e-74   9.3358e-71    2.6784e-67    6.28148e-64   1.20423e-60   1.88722e-57   2.41767e-54   2.53183e-51   2.16738e-48   1.51669e-45  8.67605e-43  4.05705e-40  1.55082e-37  4.8459e-35   1.2378e-32   2.58457e-30  4.41154e-28  6.15538e-26  7.02072e-24  6.54592e-22  4.98911e-20  3.10841e-18  1.58313e-16  6.59107e-15  2.24315e-13  6.24057e-12  1.41923e-10  2.63842e-9   4.00957e-8   4.98097e-7   5.05816e-6   4.19889e-5   0.00028493   0.00158054   0.00716698   0.0265661    0.0804977    0.199389     0.403722     0.668229     0.904131     1.0           0.904131      0.668229      0.403722      0.199389      0.0804977     0.0265661     0.00716698    0.00158054    0.00028493    4.19889e-5    5.05816e-6    4.98097e-7    4.00957e-8    2.63842e-9    1.41923e-10\n 8.15565e-106  1.43555e-101  2.06557e-97   2.42955e-93   2.336e-89     1.83605e-85   1.17966e-81   6.19572e-78   2.66005e-74   9.3358e-71    2.6784e-67    6.28148e-64   1.20423e-60   1.88722e-57   2.41767e-54   2.53183e-51   2.16738e-48  1.51669e-45  8.67605e-43  4.05705e-40  1.55082e-37  4.8459e-35   1.2378e-32   2.58457e-30  4.41154e-28  6.15538e-26  7.02072e-24  6.54592e-22  4.98911e-20  3.10841e-18  1.58313e-16  6.59107e-15  2.24315e-13  6.24057e-12  1.41923e-10  2.63842e-9   4.00957e-8   4.98097e-7   5.05816e-6   4.19889e-5   0.00028493   0.00158054   0.00716698   0.0265661    0.0804977    0.199389     0.403722     0.668229     0.904131      1.0           0.904131      0.668229      0.403722      0.199389      0.0804977     0.0265661     0.00716698    0.00158054    0.00028493    4.19889e-5    5.05816e-6    4.98097e-7    4.00957e-8    2.63842e-9\n 3.78758e-110  8.15565e-106  1.43555e-101  2.06557e-97   2.42955e-93   2.336e-89     1.83605e-85   1.17966e-81   6.19572e-78   2.66005e-74   9.3358e-71    2.6784e-67    6.28148e-64   1.20423e-60   1.88722e-57   2.41767e-54   2.53183e-51  2.16738e-48  1.51669e-45  8.67605e-43  4.05705e-40  1.55082e-37  4.8459e-35   1.2378e-32   2.58457e-30  4.41154e-28  6.15538e-26  7.02072e-24  6.54592e-22  4.98911e-20  3.10841e-18  1.58313e-16  6.59107e-15  2.24315e-13  6.24057e-12  1.41923e-10  2.63842e-9   4.00957e-8   4.98097e-7   5.05816e-6   4.19889e-5   0.00028493   0.00158054   0.00716698   0.0265661    0.0804977    0.199389     0.403722     0.668229      0.904131      1.0           0.904131      0.668229      0.403722      0.199389      0.0804977     0.0265661     0.00716698    0.00158054    0.00028493    4.19889e-5    5.05816e-6    4.98097e-7    4.00957e-8\n 1.4379e-114   3.78758e-110  8.15565e-106  1.43555e-101  2.06557e-97   2.42955e-93   2.336e-89     1.83605e-85   1.17966e-81   6.19572e-78   2.66005e-74   9.3358e-71    2.6784e-67    6.28148e-64   1.20423e-60   1.88722e-57   2.41767e-54  2.53183e-51  2.16738e-48  1.51669e-45  8.67605e-43  4.05705e-40  1.55082e-37  4.8459e-35   1.2378e-32   2.58457e-30  4.41154e-28  6.15538e-26  7.02072e-24  6.54592e-22  4.98911e-20  3.10841e-18  1.58313e-16  6.59107e-15  2.24315e-13  6.24057e-12  1.41923e-10  2.63842e-9   4.00957e-8   4.98097e-7   5.05816e-6   4.19889e-5   0.00028493   0.00158054   0.00716698   0.0265661    0.0804977    0.199389     0.403722      0.668229      0.904131      1.0           0.904131      0.668229      0.403722      0.199389      0.0804977     0.0265661     0.00716698    0.00158054    0.00028493    4.19889e-5    5.05816e-6    4.98097e-7\n 4.46227e-119  1.4379e-114   3.78758e-110  8.15565e-106  1.43555e-101  2.06557e-97   2.42955e-93   2.336e-89     1.83605e-85   1.17966e-81   6.19572e-78   2.66005e-74   9.3358e-71    2.6784e-67    6.28148e-64   1.20423e-60   1.88722e-57  2.41767e-54  2.53183e-51  2.16738e-48  1.51669e-45  8.67605e-43  4.05705e-40  1.55082e-37  4.8459e-35   1.2378e-32   2.58457e-30  4.41154e-28  6.15538e-26  7.02072e-24  6.54592e-22  4.98911e-20  3.10841e-18  1.58313e-16  6.59107e-15  2.24315e-13  6.24057e-12  1.41923e-10  2.63842e-9   4.00957e-8   4.98097e-7   5.05816e-6   4.19889e-5   0.00028493   0.00158054   0.00716698   0.0265661    0.0804977    0.199389      0.403722      0.668229      0.904131      1.0           0.904131      0.668229      0.403722      0.199389      0.0804977     0.0265661     0.00716698    0.00158054    0.00028493    4.19889e-5    5.05816e-6\n 1.132e-123    4.46227e-119  1.4379e-114   3.78758e-110  8.15565e-106  1.43555e-101  2.06557e-97   2.42955e-93   2.336e-89     1.83605e-85   1.17966e-81   6.19572e-78   2.66005e-74   9.3358e-71    2.6784e-67    6.28148e-64   1.20423e-60  1.88722e-57  2.41767e-54  2.53183e-51  2.16738e-48  1.51669e-45  8.67605e-43  4.05705e-40  1.55082e-37  4.8459e-35   1.2378e-32   2.58457e-30  4.41154e-28  6.15538e-26  7.02072e-24  6.54592e-22  4.98911e-20  3.10841e-18  1.58313e-16  6.59107e-15  2.24315e-13  6.24057e-12  1.41923e-10  2.63842e-9   4.00957e-8   4.98097e-7   5.05816e-6   4.19889e-5   0.00028493   0.00158054   0.00716698   0.0265661    0.0804977     0.199389      0.403722      0.668229      0.904131      1.0           0.904131      0.668229      0.403722      0.199389      0.0804977     0.0265661     0.00716698    0.00158054    0.00028493    4.19889e-5\n 2.34748e-128  1.132e-123    4.46227e-119  1.4379e-114   3.78758e-110  8.15565e-106  1.43555e-101  2.06557e-97   2.42955e-93   2.336e-89     1.83605e-85   1.17966e-81   6.19572e-78   2.66005e-74   9.3358e-71    2.6784e-67    6.28148e-64  1.20423e-60  1.88722e-57  2.41767e-54  2.53183e-51  2.16738e-48  1.51669e-45  8.67605e-43  4.05705e-40  1.55082e-37  4.8459e-35   1.2378e-32   2.58457e-30  4.41154e-28  6.15538e-26  7.02072e-24  6.54592e-22  4.98911e-20  3.10841e-18  1.58313e-16  6.59107e-15  2.24315e-13  6.24057e-12  1.41923e-10  2.63842e-9   4.00957e-8   4.98097e-7   5.05816e-6   4.19889e-5   0.00028493   0.00158054   0.00716698   0.0265661     0.0804977     0.199389      0.403722      0.668229      0.904131      1.0           0.904131      0.668229      0.403722      0.199389      0.0804977     0.0265661     0.00716698    0.00158054    0.00028493\n 3.9794e-133   2.34748e-128  1.132e-123    4.46227e-119  1.4379e-114   3.78758e-110  8.15565e-106  1.43555e-101  2.06557e-97   2.42955e-93   2.336e-89     1.83605e-85   1.17966e-81   6.19572e-78   2.66005e-74   9.3358e-71    2.6784e-67   6.28148e-64  1.20423e-60  1.88722e-57  2.41767e-54  2.53183e-51  2.16738e-48  1.51669e-45  8.67605e-43  4.05705e-40  1.55082e-37  4.8459e-35   1.2378e-32   2.58457e-30  4.41154e-28  6.15538e-26  7.02072e-24  6.54592e-22  4.98911e-20  3.10841e-18  1.58313e-16  6.59107e-15  2.24315e-13  6.24057e-12  1.41923e-10  2.63842e-9   4.00957e-8   4.98097e-7   5.05816e-6   4.19889e-5   0.00028493   0.00158054   0.00716698    0.0265661     0.0804977     0.199389      0.403722      0.668229      0.904131      1.0           0.904131      0.668229      0.403722      0.199389      0.0804977     0.0265661     0.00716698    0.00158054\n 5.51438e-138  3.9794e-133   2.34748e-128  1.132e-123    4.46227e-119  1.4379e-114   3.78758e-110  8.15565e-106  1.43555e-101  2.06557e-97   2.42955e-93   2.336e-89     1.83605e-85   1.17966e-81   6.19572e-78   2.66005e-74   9.3358e-71   2.6784e-67   6.28148e-64  1.20423e-60  1.88722e-57  2.41767e-54  2.53183e-51  2.16738e-48  1.51669e-45  8.67605e-43  4.05705e-40  1.55082e-37  4.8459e-35   1.2378e-32   2.58457e-30  4.41154e-28  6.15538e-26  7.02072e-24  6.54592e-22  4.98911e-20  3.10841e-18  1.58313e-16  6.59107e-15  2.24315e-13  6.24057e-12  1.41923e-10  2.63842e-9   4.00957e-8   4.98097e-7   5.05816e-6   4.19889e-5   0.00028493   0.00158054    0.00716698    0.0265661     0.0804977     0.199389      0.403722      0.668229      0.904131      1.0           0.904131      0.668229      0.403722      0.199389      0.0804977     0.0265661     0.00716698\n 6.24653e-143  5.51438e-138  3.9794e-133   2.34748e-128  1.132e-123    4.46227e-119  1.4379e-114   3.78758e-110  8.15565e-106  1.43555e-101  2.06557e-97   2.42955e-93   2.336e-89     1.83605e-85   1.17966e-81   6.19572e-78   2.66005e-74  9.3358e-71   2.6784e-67   6.28148e-64  1.20423e-60  1.88722e-57  2.41767e-54  2.53183e-51  2.16738e-48  1.51669e-45  8.67605e-43  4.05705e-40  1.55082e-37  4.8459e-35   1.2378e-32   2.58457e-30  4.41154e-28  6.15538e-26  7.02072e-24  6.54592e-22  4.98911e-20  3.10841e-18  1.58313e-16  6.59107e-15  2.24315e-13  6.24057e-12  1.41923e-10  2.63842e-9   4.00957e-8   4.98097e-7   5.05816e-6   4.19889e-5   0.00028493    0.00158054    0.00716698    0.0265661     0.0804977     0.199389      0.403722      0.668229      0.904131      1.0           0.904131      0.668229      0.403722      0.199389      0.0804977     0.0265661\n 5.7842e-148   6.24653e-143  5.51438e-138  3.9794e-133   2.34748e-128  1.132e-123    4.46227e-119  1.4379e-114   3.78758e-110  8.15565e-106  1.43555e-101  2.06557e-97   2.42955e-93   2.336e-89     1.83605e-85   1.17966e-81   6.19572e-78  2.66005e-74  9.3358e-71   2.6784e-67   6.28148e-64  1.20423e-60  1.88722e-57  2.41767e-54  2.53183e-51  2.16738e-48  1.51669e-45  8.67605e-43  4.05705e-40  1.55082e-37  4.8459e-35   1.2378e-32   2.58457e-30  4.41154e-28  6.15538e-26  7.02072e-24  6.54592e-22  4.98911e-20  3.10841e-18  1.58313e-16  6.59107e-15  2.24315e-13  6.24057e-12  1.41923e-10  2.63842e-9   4.00957e-8   4.98097e-7   5.05816e-6   4.19889e-5    0.00028493    0.00158054    0.00716698    0.0265661     0.0804977     0.199389      0.403722      0.668229      0.904131      1.0           0.904131      0.668229      0.403722      0.199389      0.0804977\n 4.37836e-153  5.7842e-148   6.24653e-143  5.51438e-138  3.9794e-133   2.34748e-128  1.132e-123    4.46227e-119  1.4379e-114   3.78758e-110  8.15565e-106  1.43555e-101  2.06557e-97   2.42955e-93   2.336e-89     1.83605e-85   1.17966e-81  6.19572e-78  2.66005e-74  9.3358e-71   2.6784e-67   6.28148e-64  1.20423e-60  1.88722e-57  2.41767e-54  2.53183e-51  2.16738e-48  1.51669e-45  8.67605e-43  4.05705e-40  1.55082e-37  4.8459e-35   1.2378e-32   2.58457e-30  4.41154e-28  6.15538e-26  7.02072e-24  6.54592e-22  4.98911e-20  3.10841e-18  1.58313e-16  6.59107e-15  2.24315e-13  6.24057e-12  1.41923e-10  2.63842e-9   4.00957e-8   4.98097e-7   5.05816e-6    4.19889e-5    0.00028493    0.00158054    0.00716698    0.0265661     0.0804977     0.199389      0.403722      0.668229      0.904131      1.0           0.904131      0.668229      0.403722      0.199389\n 2.7092e-158   4.37836e-153  5.7842e-148   6.24653e-143  5.51438e-138  3.9794e-133   2.34748e-128  1.132e-123    4.46227e-119  1.4379e-114   3.78758e-110  8.15565e-106  1.43555e-101  2.06557e-97   2.42955e-93   2.336e-89     1.83605e-85  1.17966e-81  6.19572e-78  2.66005e-74  9.3358e-71   2.6784e-67   6.28148e-64  1.20423e-60  1.88722e-57  2.41767e-54  2.53183e-51  2.16738e-48  1.51669e-45  8.67605e-43  4.05705e-40  1.55082e-37  4.8459e-35   1.2378e-32   2.58457e-30  4.41154e-28  6.15538e-26  7.02072e-24  6.54592e-22  4.98911e-20  3.10841e-18  1.58313e-16  6.59107e-15  2.24315e-13  6.24057e-12  1.41923e-10  2.63842e-9   4.00957e-8   4.98097e-7    5.05816e-6    4.19889e-5    0.00028493    0.00158054    0.00716698    0.0265661     0.0804977     0.199389      0.403722      0.668229      0.904131      1.0           0.904131      0.668229      0.403722\n 1.37036e-163  2.7092e-158   4.37836e-153  5.7842e-148   6.24653e-143  5.51438e-138  3.9794e-133   2.34748e-128  1.132e-123    4.46227e-119  1.4379e-114   3.78758e-110  8.15565e-106  1.43555e-101  2.06557e-97   2.42955e-93   2.336e-89    1.83605e-85  1.17966e-81  6.19572e-78  2.66005e-74  9.3358e-71   2.6784e-67   6.28148e-64  1.20423e-60  1.88722e-57  2.41767e-54  2.53183e-51  2.16738e-48  1.51669e-45  8.67605e-43  4.05705e-40  1.55082e-37  4.8459e-35   1.2378e-32   2.58457e-30  4.41154e-28  6.15538e-26  7.02072e-24  6.54592e-22  4.98911e-20  3.10841e-18  1.58313e-16  6.59107e-15  2.24315e-13  6.24057e-12  1.41923e-10  2.63842e-9   4.00957e-8    4.98097e-7    5.05816e-6    4.19889e-5    0.00028493    0.00158054    0.00716698    0.0265661     0.0804977     0.199389      0.403722      0.668229      0.904131      1.0           0.904131      0.668229\n 5.66616e-169  1.37036e-163  2.7092e-158   4.37836e-153  5.7842e-148   6.24653e-143  5.51438e-138  3.9794e-133   2.34748e-128  1.132e-123    4.46227e-119  1.4379e-114   3.78758e-110  8.15565e-106  1.43555e-101  2.06557e-97   2.42955e-93  2.336e-89    1.83605e-85  1.17966e-81  6.19572e-78  2.66005e-74  9.3358e-71   2.6784e-67   6.28148e-64  1.20423e-60  1.88722e-57  2.41767e-54  2.53183e-51  2.16738e-48  1.51669e-45  8.67605e-43  4.05705e-40  1.55082e-37  4.8459e-35   1.2378e-32   2.58457e-30  4.41154e-28  6.15538e-26  7.02072e-24  6.54592e-22  4.98911e-20  3.10841e-18  1.58313e-16  6.59107e-15  2.24315e-13  6.24057e-12  1.41923e-10  2.63842e-9    4.00957e-8    4.98097e-7    5.05816e-6    4.19889e-5    0.00028493    0.00158054    0.00716698    0.0265661     0.0804977     0.199389      0.403722      0.668229      0.904131      1.0           0.904131\n 1.91517e-174  5.66616e-169  1.37036e-163  2.7092e-158   4.37836e-153  5.7842e-148   6.24653e-143  5.51438e-138  3.9794e-133   2.34748e-128  1.132e-123    4.46227e-119  1.4379e-114   3.78758e-110  8.15565e-106  1.43555e-101  2.06557e-97  2.42955e-93  2.336e-89    1.83605e-85  1.17966e-81  6.19572e-78  2.66005e-74  9.3358e-71   2.6784e-67   6.28148e-64  1.20423e-60  1.88722e-57  2.41767e-54  2.53183e-51  2.16738e-48  1.51669e-45  8.67605e-43  4.05705e-40  1.55082e-37  4.8459e-35   1.2378e-32   2.58457e-30  4.41154e-28  6.15538e-26  7.02072e-24  6.54592e-22  4.98911e-20  3.10841e-18  1.58313e-16  6.59107e-15  2.24315e-13  6.24057e-12  1.41923e-10   2.63842e-9    4.00957e-8    4.98097e-7    5.05816e-6    4.19889e-5    0.00028493    0.00158054    0.00716698    0.0265661     0.0804977     0.199389      0.403722      0.668229      0.904131      1.0","category":"page"},{"location":"examples/variational/","page":"Variational problems","title":"Variational problems","text":"We define the (non-smooth) initial condition rho_0 in terms of step functions.","category":"page"},{"location":"examples/variational/","page":"Variational problems","title":"Variational problems","text":"H(x) = x > 0\nρ0 = @. H(support + 0.25) - H(support - 0.25)\nρ0 = ρ0 / sum(ρ0)\nplot(support, ρ0; label=\"Initial condition ρ0\", color=\"blue\")","category":"page"},{"location":"examples/variational/","page":"Variational problems","title":"Variational problems","text":"(Image: )","category":"page"},{"location":"examples/variational/","page":"Variational problems","title":"Variational problems","text":"G_fpe is the objective function for the implicit step scheme","category":"page"},{"location":"examples/variational/","page":"Variational problems","title":"Variational problems","text":"G_mathrmfpe(rho) = operatornameOT_varepsilon(rho_t rho) + tau F(rho)","category":"page"},{"location":"examples/variational/","page":"Variational problems","title":"Variational problems","text":"and we seek to minimise in rho.","category":"page"},{"location":"examples/variational/","page":"Variational problems","title":"Variational problems","text":"function G_fpe(ρ, ρ0, τ, ε, C)\n    return sinkhorn2(ρ, ρ0, C, ε; regularization=true, maxiter=250) + τ * (dot(Ψ, ρ) + E(ρ))\nend;","category":"page"},{"location":"examples/variational/","page":"Variational problems","title":"Variational problems","text":"step solves the implicit step problem to produce rho_t + tau from rho_t.","category":"page"},{"location":"examples/variational/","page":"Variational problems","title":"Variational problems","text":"function step(ρ0, τ, ε, C, G)\n    opt = optimize(\n        u -> G(softmax(u), ρ0, τ, ε, C),\n        ones(size(ρ0)),\n        LBFGS(),\n        Optim.Options(; iterations=50, g_tol=1e-6);\n        autodiff=:forward,\n    )\n    return softmax(Optim.minimizer(opt))\nend","category":"page"},{"location":"examples/variational/","page":"Variational problems","title":"Variational problems","text":"step (generic function with 1 method)","category":"page"},{"location":"examples/variational/","page":"Variational problems","title":"Variational problems","text":"Now we simulate N = 10 iterates of the gradient flow and plot the result.","category":"page"},{"location":"examples/variational/","page":"Variational problems","title":"Variational problems","text":"N = 10\nρ = similar(ρ0, size(ρ0, 1), N)\nρ[:, 1] = ρ0\n@suppress begin\n    for i in 2:N\n        ρ[:, i] = step(ρ[:, i - 1], τ, ε, C, G_fpe)\n    end\nend\ncolors = range(colorant\"red\"; stop=colorant\"blue\", length=N)\nplot(\n    support,\n    ρ;\n    title=L\"F(\\rho) = \\langle \\psi, \\rho \\rangle + \\langle \\rho, \\log(\\rho) \\rangle\",\n    palette=colors,\n    legend=nothing,\n)","category":"page"},{"location":"examples/variational/","page":"Variational problems","title":"Variational problems","text":"(Image: )","category":"page"},{"location":"examples/variational/#Porous-medium-equation","page":"Variational problems","title":"Porous medium equation","text":"","category":"section"},{"location":"examples/variational/","page":"Variational problems","title":"Variational problems","text":"The porous medium equation (PME) is the nonlinear PDE","category":"page"},{"location":"examples/variational/","page":"Variational problems","title":"Variational problems","text":"partial_t rho = nabla cdot (rho nabla Psi) + Delta rho^m","category":"page"},{"location":"examples/variational/","page":"Variational problems","title":"Variational problems","text":"again with Neumann boundary conditions. The value of m in the PME corresponds to picking m in the generalised entropy functional. Now, we will solve the PME with m = 2 as a Wasserstein gradient flow.","category":"page"},{"location":"examples/variational/","page":"Variational problems","title":"Variational problems","text":"function G_pme(ρ, ρ0, τ, ε, C)\n    return sinkhorn2(ρ, ρ0, C, ε; regularization=true, maxiter=250) +\n           τ * (dot(Ψ, ρ) + E(ρ; m=2))\nend;","category":"page"},{"location":"examples/variational/","page":"Variational problems","title":"Variational problems","text":"set up as previously","category":"page"},{"location":"examples/variational/","page":"Variational problems","title":"Variational problems","text":"N = 10\nρ = similar(ρ0, size(ρ0, 1), N)\nρ[:, 1] = ρ0\n@suppress begin\n    for i in 2:N\n        ρ[:, i] = step(ρ[:, i - 1], τ, ε, C, G_pme)\n    end\nend\nplot(\n    support,\n    ρ;\n    title=L\"F(\\rho) = \\langle \\psi, \\rho \\rangle + \\langle \\rho, \\rho - 1\\rangle\",\n    palette=colors,\n    legend=nothing,\n)","category":"page"},{"location":"examples/variational/","page":"Variational problems","title":"Variational problems","text":"(Image: )","category":"page"},{"location":"examples/variational/","page":"Variational problems","title":"Variational problems","text":"","category":"page"},{"location":"examples/variational/","page":"Variational problems","title":"Variational problems","text":"This page was generated using Literate.jl.","category":"page"},{"location":"#OptimalTransport.jl-Documentation","page":"Home","title":"OptimalTransport.jl Documentation","text":"","category":"section"},{"location":"#Exact-optimal-transport-(Kantorovich)-problem","page":"Home","title":"Exact optimal transport (Kantorovich) problem","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"emd\nemd2\not_plan\not_plan(::Any, ::OptimalTransport.ContinuousUnivariateDistribution, ::OptimalTransport.UnivariateDistribution)\not_plan(::Any, ::OptimalTransport.DiscreteNonParametric, ::OptimalTransport.DiscreteNonParametric)\not_plan(::OptimalTransport.SqEuclidean, ::OptimalTransport.Normal, ::OptimalTransport.Normal)\not_plan(::OptimalTransport.SqEuclidean, ::OptimalTransport.MvNormal, ::OptimalTransport.MvNormal)\not_cost\not_cost(::Any, ::OptimalTransport.ContinuousUnivariateDistribution, ::OptimalTransport.UnivariateDistribution)\not_cost(::Any, ::OptimalTransport.DiscreteNonParametric, ::OptimalTransport.DiscreteNonParametric)\not_cost(::OptimalTransport.SqEuclidean, ::OptimalTransport.Normal, ::OptimalTransport.Normal)\not_cost(::OptimalTransport.SqEuclidean, ::OptimalTransport.MvNormal, ::OptimalTransport.MvNormal)\nwasserstein\nsquared2wasserstein","category":"page"},{"location":"#OptimalTransport.emd","page":"Home","title":"OptimalTransport.emd","text":"emd(μ, ν, C, optimizer)\n\nCompute the optimal transport plan γ for the Monge-Kantorovich problem with source histogram μ, target histogram ν, and cost matrix C of size (length(μ), length(ν)) which solves\n\ninf_γ  Π(μ ν) langle γ C rangle\n\nThe corresponding linear programming problem is solved with the user-provided optimizer. Possible choices are Tulip.Optimizer() and Clp.Optimizer() in the Tulip and Clp packages, respectively.\n\n\n\n\n\n","category":"function"},{"location":"#OptimalTransport.emd2","page":"Home","title":"OptimalTransport.emd2","text":"emd2(μ, ν, C, optimizer; plan=nothing)\n\nCompute the optimal transport cost (a scalar) for the Monge-Kantorovich problem with source histogram μ, target histogram ν, and cost matrix C of size (length(μ), length(ν)) which is given by\n\ninf_γ  Π(μ ν) langle γ C rangle\n\nThe corresponding linear programming problem is solved with the user-provided optimizer. Possible choices are Tulip.Optimizer() and Clp.Optimizer() in the Tulip and Clp packages, respectively.\n\nA pre-computed optimal transport plan may be provided.\n\n\n\n\n\n","category":"function"},{"location":"#OptimalTransport.ot_plan","page":"Home","title":"OptimalTransport.ot_plan","text":"ot_plan(c, μ, ν; kwargs...)\n\nCompute the optimal transport plan for the Monge-Kantorovich problem with source and target marginals μ and ν and cost c.\n\nThe optimal transport plan solves\n\ninf_gamma in Pi(mu nu) int c(x y)  mathrmdgamma(x y)\n\nwhere Pi(mu nu) denotes the couplings of mu and nu.\n\nSee also: ot_cost\n\n\n\n\n\n","category":"function"},{"location":"#OptimalTransport.ot_plan-Tuple{Any, Distributions.Distribution{Distributions.Univariate, Distributions.Continuous}, Distributions.UnivariateDistribution{S} where S<:Distributions.ValueSupport}","page":"Home","title":"OptimalTransport.ot_plan","text":"ot_plan(c, μ::ContinuousUnivariateDistribution, ν::UnivariateDistribution)\n\nCompute the optimal transport plan for the Monge-Kantorovich problem with univariate distributions μ and ν as source and target marginals and cost function c of the form c(x y) = h(x - y) where h is a convex function.\n\nIn this setting, the optimal transport plan is the Monge map\n\nT = F_nu^-1 circ F_mu\n\nwhere F_mu is the cumulative distribution function of μ and F_nu^-1 is the quantile function of ν.\n\nSee also: ot_cost, emd\n\n\n\n\n\n","category":"method"},{"location":"#OptimalTransport.ot_plan-Tuple{Any, Distributions.DiscreteNonParametric, Distributions.DiscreteNonParametric}","page":"Home","title":"OptimalTransport.ot_plan","text":"ot_plan(c, μ::DiscreteNonParametric, ν::DiscreteNonParametric)\n\nCompute the optimal transport cost for the Monge-Kantorovich problem with univariate discrete distributions μ and ν as source and target marginals and cost function c of the form c(x y) = h(x - y) where h is a convex function.\n\nIn this setting, the optimal transport plan can be computed analytically. It is returned as a sparse matrix.\n\nSee also: ot_cost, emd\n\n\n\n\n\n","category":"method"},{"location":"#OptimalTransport.ot_plan-Tuple{Distances.SqEuclidean, Distributions.Normal, Distributions.Normal}","page":"Home","title":"OptimalTransport.ot_plan","text":"ot_plan(::SqEuclidean, μ::Normal, ν::Normal)\n\nCompute the optimal transport plan for the Monge-Kantorovich problem with normal distributions μ and ν as source and target marginals and cost function c(x y) = x - y_2^2.\n\nSee also: ot_cost, emd\n\n\n\n\n\n","category":"method"},{"location":"#OptimalTransport.ot_plan-Tuple{Distances.SqEuclidean, Distributions.MvNormal, Distributions.MvNormal}","page":"Home","title":"OptimalTransport.ot_plan","text":"ot_plan(::SqEuclidean, μ::MvNormal, ν::MvNormal)\n\nCompute the optimal transport plan for the Monge-Kantorovich problem with multivariate normal distributions μ and ν as source and target marginals and cost function c(x y) = x - y_2^2.\n\nIn this setting, for mu = mathcalN(m_mu Sigma_mu) and nu = mathcalN(m_nu Sigma_nu), the optimal transport plan is the Monge map\n\nT colon x mapsto m_nu\n+ Sigma_mu^-12\nbig(Sigma_mu^12 Sigma_nu Sigma_mu^12big)^12Sigma_mu^-12\n(x - m_mu)\n\nSee also: ot_cost, emd\n\n\n\n\n\n","category":"method"},{"location":"#OptimalTransport.ot_cost","page":"Home","title":"OptimalTransport.ot_cost","text":"ot_cost(c, μ, ν; kwargs...)\n\nCompute the optimal transport cost for the Monge-Kantorovich problem with source and target marginals μ and ν and cost c.\n\nThe optimal transport cost is the scalar value\n\ninf_gamma in Pi(mu nu) int c(x y)  mathrmdgamma(x y)\n\nwhere Pi(mu nu) denotes the couplings of mu and nu.\n\nSee also: ot_plan\n\n\n\n\n\n","category":"function"},{"location":"#OptimalTransport.ot_cost-Tuple{Any, Distributions.Distribution{Distributions.Univariate, Distributions.Continuous}, Distributions.UnivariateDistribution{S} where S<:Distributions.ValueSupport}","page":"Home","title":"OptimalTransport.ot_cost","text":"ot_cost(\n    c, μ::ContinuousUnivariateDistribution, ν::UnivariateDistribution; plan=nothing\n)\n\nCompute the optimal transport cost for the Monge-Kantorovich problem with univariate distributions μ and ν as source and target marginals and cost function c of the form c(x y) = h(x - y) where h is a convex function.\n\nIn this setting, the optimal transport cost can be computed as\n\nint_0^1 c(F_mu^-1(x) F_nu^-1(x)) mathrmdx\n\nwhere F_mu^-1 and F_nu^-1 are the quantile functions of μ and ν, respectively.\n\nA pre-computed optimal transport plan may be provided.\n\nSee also: ot_plan, emd2\n\n\n\n\n\n","category":"method"},{"location":"#OptimalTransport.ot_cost-Tuple{Any, Distributions.DiscreteNonParametric, Distributions.DiscreteNonParametric}","page":"Home","title":"OptimalTransport.ot_cost","text":"ot_cost(\n    c, μ::DiscreteNonParametric, ν::DiscreteNonParametric; plan=nothing\n)\n\nCompute the optimal transport cost for the Monge-Kantorovich problem with discrete univariate distributions μ and ν as source and target marginals and cost function c of the form c(x y) = h(x - y) where h is a convex function.\n\nIn this setting, the optimal transport cost can be computed analytically.\n\nA pre-computed optimal transport plan may be provided.\n\nSee also: ot_plan, emd2\n\n\n\n\n\n","category":"method"},{"location":"#OptimalTransport.ot_cost-Tuple{Distances.SqEuclidean, Distributions.Normal, Distributions.Normal}","page":"Home","title":"OptimalTransport.ot_cost","text":"ot_cost(::SqEuclidean, μ::Normal, ν::Normal)\n\nCompute the squared 2-Wasserstein distance between univariate normal distributions μ and ν as source and target marginals.\n\nSee also: ot_plan, emd2\n\n\n\n\n\n","category":"method"},{"location":"#OptimalTransport.ot_cost-Tuple{Distances.SqEuclidean, Distributions.MvNormal, Distributions.MvNormal}","page":"Home","title":"OptimalTransport.ot_cost","text":"ot_cost(::SqEuclidean, μ::MvNormal, ν::MvNormal)\n\nCompute the squared 2-Wasserstein distance between normal distributions μ and ν as source and target marginals.\n\nIn this setting, the optimal transport cost can be computed as\n\nW_2^2(mu nu) = m_mu - m_nu ^2 + mathcalB(Sigma_mu Sigma_nu)^2\n\nwhere mu = mathcalN(m_mu Sigma_mu), nu = mathcalN(m_nu Sigma_nu), and mathcalB is the Bures metric.\n\nSee also: ot_plan, emd2\n\n\n\n\n\n","category":"method"},{"location":"#OptimalTransport.wasserstein","page":"Home","title":"OptimalTransport.wasserstein","text":"wasserstein(μ, ν; metric=Euclidean(), p=Val(1), kwargs...)\n\nCompute the p-Wasserstein distance with respect to the metric between measures μ and ν.\n\nOrder p can be provided as a scalar of type Real or as a parameter of a value type Val(p). For certain combinations of metric and p, such as metric=Euclidean() and p=Val(2), the computations are more efficient if p is specified as a value type. The remaining keyword arguments are forwarded to ot_cost.\n\nSee also: squared2wasserstein, ot_cost\n\n\n\n\n\n","category":"function"},{"location":"#OptimalTransport.squared2wasserstein","page":"Home","title":"OptimalTransport.squared2wasserstein","text":"squared2wasserstein(μ, ν; metric=Euclidean(), kwargs...)\n\nCompute the squared 2-Wasserstein distance with respect to the metric between measures μ and ν.\n\nThe remaining keyword arguments are forwarded to ot_cost.\n\nSee also: wasserstein, ot_cost\n\n\n\n\n\n","category":"function"},{"location":"#Entropically-regularised-optimal-transport","page":"Home","title":"Entropically regularised optimal transport","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"sinkhorn\nsinkhorn2\nsinkhorn_barycenter","category":"page"},{"location":"#OptimalTransport.sinkhorn","page":"Home","title":"OptimalTransport.sinkhorn","text":"sinkhorn(\n    μ, ν, C, ε, alg=SinkhornGibbs();\n    atol=0, rtol=atol > 0 ? 0 : √eps, check_convergence=10, maxiter=1_000,\n)\n\nCompute the optimal transport plan for the entropically regularized optimal transport problem with source and target marginals μ and ν, cost matrix C of size (length(μ), length(ν)), and entropic regularization parameter ε.\n\nThe optimal transport plan γ is of the same size as C and solves\n\ninf_gamma in Pi(mu nu) langle gamma C rangle\n+ varepsilon Omega(gamma)\n\nwhere Omega(gamma) = sum_ij gamma_ij log gamma_ij is the entropic regularization term.\n\nEvery check_convergence steps it is assessed if the algorithm is converged by checking if the iterate of the transport plan G satisfies\n\nisapprox(sum(G; dims=2), μ; atol=atol, rtol=rtol, norm=x -> norm(x, 1))\n\nThe default rtol depends on the types of μ, ν, and C. After maxiter iterations, the computation is stopped.\n\nBatch computations for multiple histograms with a common cost matrix C can be performed by passing μ or ν as matrices whose columns correspond to histograms. It is required that the number of source and target marginals is equal or that a single source or single target marginal is provided (either as matrix or as vector). The optimal transport plans are returned as three-dimensional array where γ[:, :, i] is the optimal transport plan for the ith pair of source and target marginals.\n\nSee also: sinkhorn2\n\n\n\n\n\n","category":"function"},{"location":"#OptimalTransport.sinkhorn2","page":"Home","title":"OptimalTransport.sinkhorn2","text":"sinkhorn2(\n    μ, ν, C, ε, alg=SinkhornGibbs(); regularization=false, plan=nothing, kwargs...\n)\n\nSolve the entropically regularized optimal transport problem with source and target marginals μ and ν, cost matrix C of size (length(μ), length(ν)), and entropic regularization parameter ε, and return the optimal cost.\n\nA pre-computed optimal transport plan may be provided. The other keyword arguments supported here are the same as those in the sinkhorn function.\n\nnote: Note\nAs the sinkhorn2 function in the Python Optimal Transport package, this function returns the optimal transport cost without the regularization term. The cost with the regularization term can be computed by setting regularization=true.\n\nSee also: sinkhorn\n\n\n\n\n\n","category":"function"},{"location":"#OptimalTransport.sinkhorn_barycenter","page":"Home","title":"OptimalTransport.sinkhorn_barycenter","text":"sinkhorn_barycenter(μ, C, ε, w, alg = SinkhornGibbs(); kwargs...)\n\nCompute the Sinkhorn barycenter for a collection of N histograms contained in the columns of μ, for a cost matrix C of size (size(μ, 1), size(μ, 1)), relative weights w of size N, and entropic regularisation parameter ε. Returns the entropically regularised barycenter of the μ, i.e. the histogram ρ of length size(μ, 1) that solves\n\nmin_rho in Sigma sum_i = 1^N w_i operatornameOT_varepsilon(mu_i rho)\n\nwhere operatornameOT_ε(mu nu) = inf_gamma Pi(mu nu) langle gamma C rangle + varepsilon Omega(gamma) is the entropic optimal transport loss with cost C and regularisation epsilon.\n\n\n\n\n\n","category":"function"},{"location":"","page":"Home","title":"Home","text":"Currently the following variants of the Sinkhorn algorithm are supported:","category":"page"},{"location":"","page":"Home","title":"Home","text":"SinkhornGibbs\nSinkhornStabilized\nSinkhornEpsilonScaling","category":"page"},{"location":"#OptimalTransport.SinkhornGibbs","page":"Home","title":"OptimalTransport.SinkhornGibbs","text":"SinkhornGibbs()\n\nVanilla Sinkhorn algorithm.\n\n\n\n\n\n","category":"type"},{"location":"#OptimalTransport.SinkhornStabilized","page":"Home","title":"OptimalTransport.SinkhornStabilized","text":"SinkhornStabilized(; absorb_tol::Real=1_000)\n\nConstruct a log-domain stabilized Sinkhorn algorithm with absorption tolerance absorb_tol for solving an entropically regularized optimal transport problem.\n\nReferences\n\nSchmitzer, B. (2019). Stabilized Sparse Scaling Algorithms for Entropy Regularized Transport Problems. SIAM Journal on Scientific Computing, 41(3), A1443–A1481.\n\n\n\n\n\n","category":"type"},{"location":"#OptimalTransport.SinkhornEpsilonScaling","page":"Home","title":"OptimalTransport.SinkhornEpsilonScaling","text":"SinkhornEpsilonScaling(algorithm::Sinkhorn; factor=1//2, steps=5)\n\nConstruct an ε-scaling Sinkhorn algorithm for solving an entropically regularized optimal transport problem.\n\nThe function uses the specified Sinkhorn algorithm with steps ε-scaling steps with scaling factor factor. It sequentially solves the entropically regularized optimal transport with regularization parameters\n\nvarepsilon_i = varepsilon lambda^i-k qquad (i = 1ldotsk)\n\nwhere lambda is the scaling factor and k the number of scaling steps.\n\n\n\n\n\n","category":"type"},{"location":"","page":"Home","title":"Home","text":"The following methods are deprecated and will be removed:","category":"page"},{"location":"","page":"Home","title":"Home","text":"sinkhorn_stabilized\nsinkhorn_stabilized_epsscaling","category":"page"},{"location":"#OptimalTransport.sinkhorn_stabilized","page":"Home","title":"OptimalTransport.sinkhorn_stabilized","text":"sinkhorn_stabilized(μ, ν, C, ε; absorb_tol=1_000, kwargs...)\n\nThis method is deprecated, please use\n\nsinkhorn(\n    μ, ν, C, ε, SinkhornStabilized(; absorb_tol=absorb_tol); kwargs...\n)\n\ninstead.\n\nSee also: sinkhorn, SinkhornStabilized\n\n\n\n\n\n","category":"function"},{"location":"#OptimalTransport.sinkhorn_stabilized_epsscaling","page":"Home","title":"OptimalTransport.sinkhorn_stabilized_epsscaling","text":"sinkhorn_stabilized_epsscaling(\n    μ, ν, C, ε;\n    scaling_factor=1//2, scaling_steps=5, absorb_tol=1_000, kwargs...\n)\n\nThis method is deprecated, please use\n\nsinkhorn(\n    μ,\n    ν,\n    C,\n    ε,\n    SinkhornEpsilonScaling(\n        SinkhornStabilized(; absorb_tol=absorb_tol);\n        factor=scaling_factor,\n        steps=scaling_steps,\n    );\n    kwargs...,\n)\n\ninstead.\n\nSee also: sinkhorn, SinkhornEpsilonScaling\n\n\n\n\n\n","category":"function"},{"location":"#Unbalanced-optimal-transport","page":"Home","title":"Unbalanced optimal transport","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"sinkhorn_unbalanced\nsinkhorn_unbalanced2","category":"page"},{"location":"#OptimalTransport.sinkhorn_unbalanced","page":"Home","title":"OptimalTransport.sinkhorn_unbalanced","text":"sinkhorn_unbalanced(μ, ν, C, λ1::Real, λ2::Real, ε; kwargs...)\n\nCompute the optimal transport plan for the unbalanced entropically regularized optimal transport problem with source and target marginals μ and ν, cost matrix C of size (length(μ), length(ν)), entropic regularization parameter ε, and marginal relaxation terms λ1 and λ2.\n\nThe optimal transport plan γ is of the same size as C and solves\n\ninf_gamma langle gamma C rangle\n+ varepsilon Omega(gamma)\n+ lambda_1 operatornameKL(gamma 1  mu)\n+ lambda_2 operatornameKL(gamma^mathsfT 1  nu)\n\nwhere Omega(gamma) = sum_ij gamma_ij log gamma_ij is the entropic regularization term and operatornameKL is the Kullback-Leibler divergence.\n\nThe keyword arguments supported here are the same as those in the sinkhorn_unbalanced for unbalanced optimal transport problems with general soft marginal constraints.\n\n\n\n\n\nsinkhorn_unbalanced(\n    μ, ν, C, proxdivF1!, proxdivF2!, ε;\n    atol=0, rtol=atol > 0 ? 0 : √eps, check_convergence=10, maxiter=1_000,\n)\n\nCompute the optimal transport plan for the unbalanced entropically regularized optimal transport problem with source and target marginals μ and ν, cost matrix C of size (length(μ), length(ν)), entropic regularization parameter ε, and soft marginal constraints F_1 and F_2 with \"proxdiv\" functions proxdivF! and proxdivG!.\n\nThe optimal transport plan γ is of the same size as C and solves\n\ninf_gamma langle gamma C rangle\n+ varepsilon Omega(gamma)\n+ F_1(gamma 1 mu)\n+ F_2(gamma^mathsfT 1 nu)\n\nwhere Omega(gamma) = sum_ij gamma_ij log gamma_ij is the entropic regularization term and F_1(cdot mu) and F_2(cdot nu) are soft marginal constraints for the source and target marginals.\n\nThe functions proxdivF1!(s, p, ε) and proxdivF2!(s, p, ε) evaluate the \"proxdiv\" functions of F_1(cdot p) and F_2(cdot p) at s for the entropic regularization parameter varepsilon. They have to be mutating and overwrite the first argument s with the result of their computations.\n\nMathematically, the \"proxdiv\" functions are defined as\n\noperatornameproxdiv_F_i(s p varepsilon)\n= operatornameprox^operatornameKL_F_i(cdot p)varepsilon(s) oslash s\n\nwhere oslash denotes element-wise division and operatornameprox_F_i(cdot p)varepsilon^operatornameKL is the proximal operator of F_i(cdot p)varepsilon for the Kullback-Leibler (operatornameKL) divergence.  It is defined as\n\noperatornameprox_F^operatornameKL(x)\n= operatornameargmin_y F(y) + operatornameKL(yx)\n\nand can be computed in closed-form for specific choices of F. For instance, if F(cdot p) = lambda operatornameKL(cdot  p) (lambda  0), then\n\noperatornameprox_F(cdot p)varepsilon^operatornameKL(x)\n= x^fracvarepsilonvarepsilon + lambda p^fraclambdavarepsilon + lambda\n\nwhere all operators are acting pointwise.[CPSV18]\n\nEvery check_convergence steps it is assessed if the algorithm is converged by checking if the iterates of the scaling factor in the current and previous iteration satisfy isapprox(vcat(a, b), vcat(aprev, bprev); atol=atol, rtol=rtol) where a and b are the current iterates and aprev and bprev the previous ones. The default rtol depends on the types of μ, ν, and C. After maxiter iterations, the computation is stopped.\n\n[CPSV18]: Chizat, L., Peyré, G., Schmitzer, B., & Vialard, F.-X. (2018). Scaling algorithms for unbalanced optimal transport problems. Mathematics of Computation, 87(314), 2563–2609.\n\nSee also: sinkhorn_unbalanced2\n\n\n\n\n\n","category":"function"},{"location":"#OptimalTransport.sinkhorn_unbalanced2","page":"Home","title":"OptimalTransport.sinkhorn_unbalanced2","text":"sinkhorn_unbalanced2(μ, ν, C, λ1, λ2, ε; plan=nothing, kwargs...)\nsinkhorn_unbalanced2(μ, ν, C, proxdivF1!, proxdivF2!, ε; plan=nothing, kwargs...)\n\nCompute the optimal transport plan for the unbalanced entropically regularized optimal transport problem with source and target marginals μ and ν, cost matrix C of size (length(μ), length(ν)), entropic regularization parameter ε, and marginal relaxation terms λ1 and λ2 or soft marginal constraints with \"proxdiv\" functions proxdivF1! and proxdivF2!.\n\nA pre-computed optimal transport plan may be provided. The other keyword arguments supported here are the same as those in the sinkhorn_unbalanced for unbalanced optimal transport problems with general soft marginal constraints.\n\nSee also: sinkhorn_unbalanced\n\n\n\n\n\n","category":"function"},{"location":"#Quadratically-regularised-optimal-transport","page":"Home","title":"Quadratically regularised optimal transport","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"quadreg","category":"page"},{"location":"#OptimalTransport.quadreg","page":"Home","title":"OptimalTransport.quadreg","text":"quadreg(μ, ν, C, ε, alg::QuadraticOT; kwargs...)\n\nComputes the optimal transport plan of histograms μ and ν with cost matrix C and quadratic regularization parameter ε. \n\nThe optimal transport plan γ is of the same size as C and solves \n\ninf_gamma in Pi(mu nu) langle gamma C rangle\n+ varepsilon Omega(gamma)\n\nwhere Omega(gamma) = frac12 sum_ij gamma_ij^2 is the quadratic  regularization term.\n\nEvery check_convergence steps it is assessed if the algorithm is converged by checking if the iterate of the transport plan γ satisfies\n\n    norm_diff < max(atol, rtol * max(norm(μ, Inf), norm(ν, Inf)))\n\nwhere\n\n    textnormdiff = max  gamma mathbf1 - mu _infty    gamma^top mathbf1 - nu _infty    \n\nAfter maxiter iterations, the computation is stopped.\n\nNote that unlike in the case of Sinkhorn's algorithm for the entropic regularisation, batch computation of optimal transport is not supported for the quadratic regularisation. \n\nSee also: sinkhorn, QuadraticOTNewton\n\n\n\n\n\n","category":"function"},{"location":"","page":"Home","title":"Home","text":"Currently the following algorithms for solving quadratically regularised optimal transport are supported:","category":"page"},{"location":"","page":"Home","title":"Home","text":"QuadraticOTNewton","category":"page"},{"location":"#OptimalTransport.QuadraticOTNewton","page":"Home","title":"OptimalTransport.QuadraticOTNewton","text":"QuadraticOTNewton\n\nSemi-smooth Newton method (Algorithm 2 of Lorenz et al. 2019 [LMM19]) for solving quadratically regularised optimal transport\n\n[LMM19]: Lorenz, Dirk A., Paul Manns, and Christian Meyer. Quadratically regularized optimal transport. Applied Mathematics & Optimization 83.3 (2021): 1919-1949.\n\nSee also: QuadraticOTNewton, quadreg\n\n\n\n\n\n","category":"type"},{"location":"examples/basic/","page":"Basics","title":"Basics","text":"EditURL = \"https://github.com/JuliaOptimalTransport/OptimalTransport.jl/blob/master/examples/basic/script.jl\"","category":"page"},{"location":"examples/basic/#Basics","page":"Basics","title":"Basics","text":"","category":"section"},{"location":"examples/basic/","page":"Basics","title":"Basics","text":"(Image: )","category":"page"},{"location":"examples/basic/","page":"Basics","title":"Basics","text":"You are seeing the HTML output generated by Documenter.jl and Literate.jl from the Julia source file. The corresponding notebook can be viewed in nbviewer.","category":"page"},{"location":"examples/basic/#Packages","page":"Basics","title":"Packages","text":"","category":"section"},{"location":"examples/basic/","page":"Basics","title":"Basics","text":"We load the following packages into our environment:","category":"page"},{"location":"examples/basic/","page":"Basics","title":"Basics","text":"using OptimalTransport\nusing Distances\nusing Plots\nusing PythonOT: PythonOT\nusing Tulip\n\nusing LinearAlgebra\nusing Random\n\nRandom.seed!(1234)\n\nconst POT = PythonOT","category":"page"},{"location":"examples/basic/","page":"Basics","title":"Basics","text":"PythonOT","category":"page"},{"location":"examples/basic/#Problem-setup","page":"Basics","title":"Problem setup","text":"","category":"section"},{"location":"examples/basic/","page":"Basics","title":"Basics","text":"First, let us initialise two random probability measures mu (source measure) and nu (target measure) in 1D:","category":"page"},{"location":"examples/basic/","page":"Basics","title":"Basics","text":"M = 200\nμ = fill(1 / M, M)\nμsupport = rand(M)\n\nN = 250\nν = fill(1 / N, N)\nνsupport = rand(N);","category":"page"},{"location":"examples/basic/","page":"Basics","title":"Basics","text":"Now we compute the quadratic cost matrix C_ij =  x_i - x_j _2^2:","category":"page"},{"location":"examples/basic/","page":"Basics","title":"Basics","text":"C = pairwise(SqEuclidean(), μsupport', νsupport'; dims=2);","category":"page"},{"location":"examples/basic/#Exact-optimal-transport","page":"Basics","title":"Exact optimal transport","text":"","category":"section"},{"location":"examples/basic/","page":"Basics","title":"Basics","text":"The earth mover's distance is defined as the optimal value of the Monge-Kantorovich problem","category":"page"},{"location":"examples/basic/","page":"Basics","title":"Basics","text":"inf_gamma in Pi(mu nu) langle gamma C rangle =\ninf_gamma in Pi(mu nu) sum_i j gamma_ij C_ij","category":"page"},{"location":"examples/basic/","page":"Basics","title":"Basics","text":"where Pi(mu nu) denotes the set of couplings of mu and nu, i.e., the set of joint distributions whose marginals are mu and nu. If C is the quadratic cost matrix, the earth mover's distance is known as the square of the 2-Wasserstein distance.","category":"page"},{"location":"examples/basic/","page":"Basics","title":"Basics","text":"The function emd returns the optimal transport plan gamma","category":"page"},{"location":"examples/basic/","page":"Basics","title":"Basics","text":"γ = emd(μ, ν, C, Tulip.Optimizer());","category":"page"},{"location":"examples/basic/","page":"Basics","title":"Basics","text":"whilst using emd2 returns the optimal transport cost:","category":"page"},{"location":"examples/basic/","page":"Basics","title":"Basics","text":"emd2(μ, ν, C, Tulip.Optimizer())","category":"page"},{"location":"examples/basic/","page":"Basics","title":"Basics","text":"0.0006423893452596193","category":"page"},{"location":"examples/basic/#Entropically-regularised-optimal-transport","page":"Basics","title":"Entropically regularised optimal transport","text":"","category":"section"},{"location":"examples/basic/","page":"Basics","title":"Basics","text":"We may add an entropy term to the Monge-Kantorovich problem to obtain the entropically regularised optimal transport problem","category":"page"},{"location":"examples/basic/","page":"Basics","title":"Basics","text":"inf_gamma in Pi(mu nu) langle gamma C rangle + epsilon Omega(gamma)","category":"page"},{"location":"examples/basic/","page":"Basics","title":"Basics","text":"where Omega(gamma) = sum_i j gamma_ij log(gamma_ij) is the negative entropy of the coupling gamma and epsilon controls the strength of the regularisation.","category":"page"},{"location":"examples/basic/","page":"Basics","title":"Basics","text":"This problem is strictly convex and admits a very efficient iterative scaling scheme for its solution known as the Sinkhorn algorithm.","category":"page"},{"location":"examples/basic/","page":"Basics","title":"Basics","text":"We compute the optimal entropically regularised transport plan:","category":"page"},{"location":"examples/basic/","page":"Basics","title":"Basics","text":"ε = 0.01\nγ = sinkhorn(μ, ν, C, ε);","category":"page"},{"location":"examples/basic/","page":"Basics","title":"Basics","text":"We can check that one obtains the same result with the Python Optimal Transport (POT) package:","category":"page"},{"location":"examples/basic/","page":"Basics","title":"Basics","text":"γpot = POT.sinkhorn(μ, ν, C, ε)\nnorm(γ - γpot, Inf)","category":"page"},{"location":"examples/basic/","page":"Basics","title":"Basics","text":"5.781996301017223e-12","category":"page"},{"location":"examples/basic/","page":"Basics","title":"Basics","text":"We can compute the optimal cost (a scalar) of the entropically regularized optimal transport problem with sinkhorn2:","category":"page"},{"location":"examples/basic/","page":"Basics","title":"Basics","text":"sinkhorn2(μ, ν, C, ε)","category":"page"},{"location":"examples/basic/","page":"Basics","title":"Basics","text":"0.005117874184265585","category":"page"},{"location":"examples/basic/#Quadratically-regularised-optimal-transport","page":"Basics","title":"Quadratically regularised optimal transport","text":"","category":"section"},{"location":"examples/basic/","page":"Basics","title":"Basics","text":"Instead of the common entropically regularised optimal transport problem, we can solve the quadratically regularised optimal transport problem","category":"page"},{"location":"examples/basic/","page":"Basics","title":"Basics","text":"inf_gamma in Pi(mu nu) langle gamma C rangle + epsilon frac gamma _F^22","category":"page"},{"location":"examples/basic/","page":"Basics","title":"Basics","text":"One property of the quadratically regularised optimal transport problem is that the resulting transport plan gamma is sparse. We take advantage of this and represent it as a sparse matrix.","category":"page"},{"location":"examples/basic/","page":"Basics","title":"Basics","text":"quadreg(μ, ν, C, ε; maxiter=100);","category":"page"},{"location":"examples/basic/#Stabilized-Sinkhorn-algorithm","page":"Basics","title":"Stabilized Sinkhorn algorithm","text":"","category":"section"},{"location":"examples/basic/","page":"Basics","title":"Basics","text":"When epsilon is very small, we can use a log-stabilised version of the Sinkhorn algorithm.","category":"page"},{"location":"examples/basic/","page":"Basics","title":"Basics","text":"ε = 0.005\nγ = sinkhorn_stabilized(μ, ν, C, ε; maxiter=5_000);","category":"page"},{"location":"examples/basic/","page":"Basics","title":"Basics","text":"Again we can check that the same result is obtained with the POT package:","category":"page"},{"location":"examples/basic/","page":"Basics","title":"Basics","text":"γ_pot = POT.sinkhorn(μ, ν, C, ε; method=\"sinkhorn_stabilized\", numItermax=5_000)\nnorm(γ - γ_pot, Inf)","category":"page"},{"location":"examples/basic/","page":"Basics","title":"Basics","text":"1.0194207782608655e-11","category":"page"},{"location":"examples/basic/#Stabilized-Sinkhorn-algorithm-with-\\epsilon-scaling","page":"Basics","title":"Stabilized Sinkhorn algorithm with epsilon-scaling","text":"","category":"section"},{"location":"examples/basic/","page":"Basics","title":"Basics","text":"In addition to log-stabilisation, we can use epsilon-scaling:","category":"page"},{"location":"examples/basic/","page":"Basics","title":"Basics","text":"γ = sinkhorn_stabilized_epsscaling(μ, ν, C, ε; maxiter=5_000);","category":"page"},{"location":"examples/basic/","page":"Basics","title":"Basics","text":"The POT package yields the same result:","category":"page"},{"location":"examples/basic/","page":"Basics","title":"Basics","text":"γpot = POT.sinkhorn(μ, ν, C, ε; method=\"sinkhorn_epsilon_scaling\", numItermax=5000)\nnorm(γ - γpot, Inf)","category":"page"},{"location":"examples/basic/","page":"Basics","title":"Basics","text":"2.179203825313121e-11","category":"page"},{"location":"examples/basic/#Unbalanced-optimal-transport","page":"Basics","title":"Unbalanced optimal transport","text":"","category":"section"},{"location":"examples/basic/","page":"Basics","title":"Basics","text":"Unbalanced optimal transport deals with general positive measures which do not necessarily have the same total mass. For unbalanced source and target marginals mu and nu and a cost matrix C, entropically regularised unbalanced optimal transport solves","category":"page"},{"location":"examples/basic/","page":"Basics","title":"Basics","text":"inf_gamma geq 0 langle gamma C rangle + epsilon Omega(gamma) + lambda_1 mathrmKL(gamma 1  mu) + lambda_2 mathrmKL(gamma^mathsfT 1  nu)","category":"page"},{"location":"examples/basic/","page":"Basics","title":"Basics","text":"where epsilon controls the strength of the entropic regularisation, and lambda_1 and lambda_2 control how strongly we enforce the marginal constraints.","category":"page"},{"location":"examples/basic/","page":"Basics","title":"Basics","text":"We construct two random measures, now with different total masses:","category":"page"},{"location":"examples/basic/","page":"Basics","title":"Basics","text":"M = 100\nμ = fill(1 / M, M)\nμsupport = rand(M)\n\nN = 200\nν = fill(1 / M, N)\nνsupport = rand(N);","category":"page"},{"location":"examples/basic/","page":"Basics","title":"Basics","text":"We compute the quadratic cost matrix:","category":"page"},{"location":"examples/basic/","page":"Basics","title":"Basics","text":"C = pairwise(SqEuclidean(), μsupport', νsupport'; dims=2);","category":"page"},{"location":"examples/basic/","page":"Basics","title":"Basics","text":"Now we solve the corresponding unbalanced, entropy-regularised transport problem with epsilon = 001 and lambda_1 = lambda_2 = 1:","category":"page"},{"location":"examples/basic/","page":"Basics","title":"Basics","text":"ε = 0.01\nλ = 1\nγ = sinkhorn_unbalanced(μ, ν, C, λ, λ, ε);","category":"page"},{"location":"examples/basic/","page":"Basics","title":"Basics","text":"We check that the result agrees with POT:","category":"page"},{"location":"examples/basic/","page":"Basics","title":"Basics","text":"γpot = POT.sinkhorn_unbalanced(μ, ν, C, ε, λ)\nnorm(γ - γpot, Inf)","category":"page"},{"location":"examples/basic/","page":"Basics","title":"Basics","text":"1.3149128927619075e-9","category":"page"},{"location":"examples/basic/#Plots","page":"Basics","title":"Plots","text":"","category":"section"},{"location":"examples/basic/#Entropically-regularised-transport","page":"Basics","title":"Entropically regularised transport","text":"","category":"section"},{"location":"examples/basic/","page":"Basics","title":"Basics","text":"Let us construct source and target measures again:","category":"page"},{"location":"examples/basic/","page":"Basics","title":"Basics","text":"μsupport = νsupport = range(-2, 2; length=100)\nC = pairwise(SqEuclidean(), μsupport', νsupport'; dims=2)\nμ = normalize!(exp.(-μsupport .^ 2 ./ 0.5^2), 1)\nν = normalize!(νsupport .^ 2 .* exp.(-νsupport .^ 2 ./ 0.5^2), 1)\n\nplot(μsupport, μ; label=raw\"$\\mu$\", size=(600, 400))\nplot!(νsupport, ν; label=raw\"$\\nu$\")","category":"page"},{"location":"examples/basic/","page":"Basics","title":"Basics","text":"(Image: )","category":"page"},{"location":"examples/basic/","page":"Basics","title":"Basics","text":"Now we compute the entropically regularised transport plan:","category":"page"},{"location":"examples/basic/","page":"Basics","title":"Basics","text":"γ = sinkhorn(μ, ν, C, 0.01)\nheatmap(\n    μsupport,\n    νsupport,\n    γ;\n    title=\"Entropically regularised optimal transport\",\n    size=(600, 600),\n)","category":"page"},{"location":"examples/basic/","page":"Basics","title":"Basics","text":"(Image: )","category":"page"},{"location":"examples/basic/#Quadratically-regularised-transport","page":"Basics","title":"Quadratically regularised transport","text":"","category":"section"},{"location":"examples/basic/","page":"Basics","title":"Basics","text":"Notice how the \"edges\" of the transport plan are sharper if we use quadratic regularisation instead of entropic regularisation:","category":"page"},{"location":"examples/basic/","page":"Basics","title":"Basics","text":"γquad = quadreg(μ, ν, C, 5; maxiter=100);\nheatmap(\n    μsupport,\n    νsupport,\n    γquad;\n    title=\"Quadratically regularised optimal transport\",\n    size=(600, 600),\n)","category":"page"},{"location":"examples/basic/","page":"Basics","title":"Basics","text":"(Image: )","category":"page"},{"location":"examples/basic/#Sinkhorn-barycenters","page":"Basics","title":"Sinkhorn barycenters","text":"","category":"section"},{"location":"examples/basic/","page":"Basics","title":"Basics","text":"For a collection of discrete probability measures mu_i_i=1^N subset mathcalP, cost matrices C_i_i=1^N, and positive weights lambda_i_i=1^N summing to 1, the entropically regularised barycenter in mathcalP is the discrete probability measure mu that solves","category":"page"},{"location":"examples/basic/","page":"Basics","title":"Basics","text":"inf_mu in mathcalP sum_i = 1^N lambda_i operatornameOT_epsilon(mu mu_i)","category":"page"},{"location":"examples/basic/","page":"Basics","title":"Basics","text":"where operatornameOT_epsilon(mu mu_i) denotes the entropically regularised optimal transport cost with marginals mu and mu_i, cost matrix C, and entropic regularisation parameter epsilon.","category":"page"},{"location":"examples/basic/","page":"Basics","title":"Basics","text":"We set up two measures and compute the weighted barycenters. We choose weights lambda_1 in 025 05 075.","category":"page"},{"location":"examples/basic/","page":"Basics","title":"Basics","text":"support = range(-1, 1; length=250)\nmu1 = normalize!(exp.(-(support .+ 0.5) .^ 2 ./ 0.1^2), 1)\nmu2 = normalize!(exp.(-(support .- 0.5) .^ 2 ./ 0.1^2), 1)\n\nplt = plot(; size=(800, 400), legend=:outertopright)\nplot!(plt, support, mu1; label=raw\"$\\mu_1$\")\nplot!(plt, support, mu2; label=raw\"$\\mu_2$\")\n\nmu = hcat(mu1, mu2)\nC = pairwise(SqEuclidean(), support'; dims=2)\nfor λ1 in (0.25, 0.5, 0.75)\n    λ2 = 1 - λ1\n    a = sinkhorn_barycenter(mu, C, 0.01, [λ1, λ2], SinkhornGibbs())\n    plot!(plt, support, a; label=\"\\$\\\\mu \\\\quad (\\\\lambda_1 = $λ1)\\$\")\nend\nplt","category":"page"},{"location":"examples/basic/","page":"Basics","title":"Basics","text":"(Image: )","category":"page"},{"location":"examples/basic/","page":"Basics","title":"Basics","text":"","category":"page"},{"location":"examples/basic/","page":"Basics","title":"Basics","text":"This page was generated using Literate.jl.","category":"page"}]
}
